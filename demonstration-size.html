<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alexander D. Silberman">
<meta name="dcterms.date" content="2025-12-09">

<title>Predicting Demonstration Size on Salience and Demographic Characteristics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="demonstration-size_files/libs/clipboard/clipboard.min.js"></script>
<script src="demonstration-size_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="demonstration-size_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="demonstration-size_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="demonstration-size_files/libs/quarto-html/popper.min.js"></script>
<script src="demonstration-size_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="demonstration-size_files/libs/quarto-html/anchor.min.js"></script>
<link href="demonstration-size_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="demonstration-size_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="demonstration-size_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="demonstration-size_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="demonstration-size_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#predicting-demonstration-size-on-salience-and-demographic-characteristics" id="toc-predicting-demonstration-size-on-salience-and-demographic-characteristics" class="nav-link active" data-scroll-target="#predicting-demonstration-size-on-salience-and-demographic-characteristics">Predicting Demonstration Size on Salience and Demographic Characteristics</a>
  <ul class="collapse">
  <li><a href="#gw-dats-6103-introduction-to-data-mining-final-project" id="toc-gw-dats-6103-introduction-to-data-mining-final-project" class="nav-link" data-scroll-target="#gw-dats-6103-introduction-to-data-mining-final-project">GW DATS 6103: Introduction to Data Mining Final Project</a>
  <ul class="collapse">
  <li><a href="#name-alexander-d.-silberman" id="toc-name-alexander-d.-silberman" class="nav-link" data-scroll-target="#name-alexander-d.-silberman">Name: Alexander D. Silberman</a></li>
  </ul></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#objective" id="toc-objective" class="nav-link" data-scroll-target="#objective">Objective</a></li>
  <li><a href="#impact" id="toc-impact" class="nav-link" data-scroll-target="#impact">Impact</a></li>
  </ul></li>
  <li><a href="#data-acquisition-and-wrangling" id="toc-data-acquisition-and-wrangling" class="nav-link" data-scroll-target="#data-acquisition-and-wrangling">Data Acquisition and Wrangling</a>
  <ul class="collapse">
  <li><a href="#results-dataset-crowd-counting-consortium-phase-1-2017-2020" id="toc-results-dataset-crowd-counting-consortium-phase-1-2017-2020" class="nav-link" data-scroll-target="#results-dataset-crowd-counting-consortium-phase-1-2017-2020">Results Dataset: Crowd Counting Consortium Phase 1 (2017-2020)</a></li>
  <li><a href="#american-community-survey-1-year-estimates" id="toc-american-community-survey-1-year-estimates" class="nav-link" data-scroll-target="#american-community-survey-1-year-estimates">American Community Survey 1-Year Estimates</a></li>
  <li><a href="#most-important-problem-dataset-second-release-2024" id="toc-most-important-problem-dataset-second-release-2024" class="nav-link" data-scroll-target="#most-important-problem-dataset-second-release-2024">Most Important Problem Dataset, Second Release (2024)</a></li>
  <li><a href="#merge-the-datasets" id="toc-merge-the-datasets" class="nav-link" data-scroll-target="#merge-the-datasets">Merge the Datasets</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling">Modeling</a>
  <ul class="collapse">
  <li><a href="#regression" id="toc-regression" class="nav-link" data-scroll-target="#regression">Regression</a></li>
  <li><a href="#tree" id="toc-tree" class="nav-link" data-scroll-target="#tree">Tree</a></li>
  <li><a href="#random-forest" id="toc-random-forest" class="nav-link" data-scroll-target="#random-forest">Random Forest</a></li>
  <li><a href="#k-nearest-neighbors" id="toc-k-nearest-neighbors" class="nav-link" data-scroll-target="#k-nearest-neighbors">K Nearest Neighbors</a></li>
  </ul></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation">Model Evaluation</a>
  <ul class="collapse">
  <li><a href="#check-performance-metrics-like-accuracy-precision-f1-score-recall." id="toc-check-performance-metrics-like-accuracy-precision-f1-score-recall." class="nav-link" data-scroll-target="#check-performance-metrics-like-accuracy-precision-f1-score-recall.">Check performance metrics like Accuracy, Precision, F1-score, Recall.</a></li>
  <li><a href="#plot-the-one-vs.-rest-multiclass-roc-auc-curves-for-the-best-trained-classifiers" id="toc-plot-the-one-vs.-rest-multiclass-roc-auc-curves-for-the-best-trained-classifiers" class="nav-link" data-scroll-target="#plot-the-one-vs.-rest-multiclass-roc-auc-curves-for-the-best-trained-classifiers">Plot the One vs.&nbsp;Rest multiclass ROC-AUC curves for the best trained classifiers</a></li>
  <li><a href="#plot-the-residuals-for-the-best-trained-regressors" id="toc-plot-the-residuals-for-the-best-trained-regressors" class="nav-link" data-scroll-target="#plot-the-residuals-for-the-best-trained-regressors">Plot the residuals for the best trained regressors</a></li>
  </ul></li>
  <li><a href="#dimensionality-reduction" id="toc-dimensionality-reduction" class="nav-link" data-scroll-target="#dimensionality-reduction">Dimensionality Reduction</a>
  <ul class="collapse">
  <li><a href="#primary-component-analysis" id="toc-primary-component-analysis" class="nav-link" data-scroll-target="#primary-component-analysis">Primary Component Analysis</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predicting Demonstration Size on Salience and Demographic Characteristics</h1>
<p class="subtitle lead">GW DATS 6103: Introduction to Data Mining Final Project</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alexander D. Silberman </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 9, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="predicting-demonstration-size-on-salience-and-demographic-characteristics" class="level1">
<h1>Predicting Demonstration Size on Salience and Demographic Characteristics</h1>
<section id="gw-dats-6103-introduction-to-data-mining-final-project" class="level2">
<h2 class="anchored" data-anchor-id="gw-dats-6103-introduction-to-data-mining-final-project">GW DATS 6103: Introduction to Data Mining Final Project</h2>
<section id="name-alexander-d.-silberman" class="level3">
<h3 class="anchored" data-anchor-id="name-alexander-d.-silberman">Name: Alexander D. Silberman</h3>
<p>Note: Data is limited to 2017–2018, as that is the publicly-available overlap.</p>
<div id="963aa1d4" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import cuml</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># %load_ext cuml.accel</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_colwidth'</span>, <span class="dv">1000</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> census <span class="im">import</span> Census</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> us <span class="im">import</span> states</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> censusdis.data <span class="im">as</span> ced</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> censusdis.datasets <span class="im">import</span> ACS1_PROFILE</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> censusdis <span class="im">import</span> states</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statsmodels.formula.api <span class="im">import</span> ols <span class="co"># for linear regression</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split, KFold, GridSearchCV</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler, LabelBinarizer</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression, LogisticRegression, LassoCV</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeRegressor, DecisionTreeClassifier, plot_tree</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier, RandomForestRegressor</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier, KNeighborsRegressor</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, roc_curve, auc</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>seed <span class="op">=</span> <span class="dv">42</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<section id="objective" class="level3">
<h3 class="anchored" data-anchor-id="objective">Objective</h3>
<p>To predict the size of demonstrations/protests based on metropolitan area demographics and the salience of the issue at hand.</p>
</section>
<section id="impact" class="level3">
<h3 class="anchored" data-anchor-id="impact">Impact</h3>
<p>In recent years, protests in the US have grown in both number and scale. Being able to predict the scale of future protests would allow for a more efficient distribution of resources and would enable protesters, government institutions, first responders, and news organizations—among others—to better prepare for what is to come.</p>
</section>
</section>
<section id="data-acquisition-and-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-acquisition-and-wrangling">Data Acquisition and Wrangling</h2>
<section id="results-dataset-crowd-counting-consortium-phase-1-2017-2020" class="level3">
<h3 class="anchored" data-anchor-id="results-dataset-crowd-counting-consortium-phase-1-2017-2020">Results Dataset: Crowd Counting Consortium Phase 1 (2017-2020)</h3>
<p>Our results dataset: Crowd Counting Consortium Phase 1 (2017-2020): https://ash.harvard.edu/programs/crowd-counting-consortium/</p>
<div id="92be85d7" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>crowd_data_orig <span class="op">=</span> pd.read_csv(<span class="st">"C:/Users/alexa/Code/GW DATS/6103 12 Intro to Data Mining/Final Project/data/crowd_counting_consortium_2017-2020/ccc_compiled_20172020.csv"</span>,encoding_errors<span class="op">=</span><span class="st">"replace"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>crowd_data_orig.head(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\alexa\AppData\Local\Temp\ipykernel_37948\1640917472.py:1: DtypeWarning:

Columns (6,22,31,32,33,34,35,36,37,38,39,40,41) have mixed types. Specify dtype option on import or set low_memory=False.
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">locality</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">location_detail</th>
<th data-quarto-table-cell-role="th">online</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">macroevent</th>
<th data-quarto-table-cell-role="th">actors</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">source_28</th>
<th data-quarto-table-cell-role="th">source_29</th>
<th data-quarto-table-cell-role="th">source_30</th>
<th data-quarto-table-cell-role="th">notes</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">resolved_locality</th>
<th data-quarto-table-cell-role="th">resolved_county</th>
<th data-quarto-table-cell-role="th">resolved_state</th>
<th data-quarto-table-cell-role="th">fips_code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2017-01-01</td>
<td>Washington</td>
<td>DC</td>
<td>Lafayette Square Park</td>
<td>0.0</td>
<td>vigil</td>
<td>NaN</td>
<td>NaN</td>
<td>for banning nuclear weapons, for peace</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>White House Peace Vigil continuous since June 3, 1981</td>
<td>38.907192</td>
<td>-77.036871</td>
<td>Washington</td>
<td>District of Columbia</td>
<td>DC</td>
<td>11001.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2017-01-01</td>
<td>Mankato</td>
<td>MN</td>
<td>NaN</td>
<td>0.0</td>
<td>vigil</td>
<td>NaN</td>
<td>Peace Vigil Mankato</td>
<td>for peace</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>every Sunday since 2001</td>
<td>44.163578</td>
<td>-93.999400</td>
<td>Mankato</td>
<td>Blue Earth County</td>
<td>MN</td>
<td>27013.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2017-01-01</td>
<td>Minneapolis</td>
<td>MN</td>
<td>U.S. Bank Stadium</td>
<td>0.0</td>
<td>protest; banner drop</td>
<td>NaN</td>
<td>general protestors</td>
<td>against the Dakota Access Pipeline, for indigenous rights, for environment, pressure US Bank to divest from pipeline</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>hung banner from stadium roof during NFL game</td>
<td>44.977753</td>
<td>-93.265011</td>
<td>Minneapolis</td>
<td>Hennepin County</td>
<td>MN</td>
<td>27053.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2017-01-01</td>
<td>Little Compton</td>
<td>RI</td>
<td>Town Green</td>
<td>0.0</td>
<td>vigil</td>
<td>NaN</td>
<td>Sakonnet Peace Alliance</td>
<td>for peace, for gun control, for climate action</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>every Sunday since 2003</td>
<td>41.510103</td>
<td>-71.171156</td>
<td>Little Compton</td>
<td>Newport County</td>
<td>RI</td>
<td>44005.0</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2017-01-01</td>
<td>Oak Ridge</td>
<td>TN</td>
<td>Y-12 National Security Complex</td>
<td>0.0</td>
<td>vigil</td>
<td>NaN</td>
<td>Oak Ridge Environmental Peace Alliance</td>
<td>for abolishing nuclear weapons</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>every Sunday since the late 1990s</td>
<td>36.010356</td>
<td>-84.269645</td>
<td>Oak Ridge</td>
<td>Anderson County</td>
<td>TN</td>
<td>47001.0</td>
</tr>
</tbody>
</table>

<p>5 rows × 62 columns</p>
</div>
</div>
</div>
<p>Keep only data with a crowd size, information about what the crowd gathered for, and a FIPS code, and which aren’t online.</p>
<div id="61c4feea" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>crowd_data <span class="op">=</span> crowd_data_orig[(crowd_data_orig[<span class="st">"issues"</span>].notna()) <span class="op">&amp;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                             (crowd_data_orig[<span class="st">"size_mean"</span>].notna()) <span class="op">&amp;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                             (crowd_data_orig[<span class="st">"fips_code"</span>].notna()) <span class="op">&amp;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                             (crowd_data_orig[<span class="st">"online"</span>] <span class="op">==</span> <span class="dv">0</span>) <span class="op">&amp;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                             (crowd_data_orig[<span class="st">"size_mean"</span>] <span class="op">!=</span> <span class="dv">0</span>) <span class="op">&amp;</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                             (crowd_data_orig[<span class="st">"size_mean"</span>].notna()) <span class="op">&amp;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                             (crowd_data_orig[<span class="st">"type"</span>].notna())]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>crowd_data.drop(columns<span class="op">=</span>np.array([<span class="st">"source_"</span>]<span class="op">*</span><span class="dv">30</span>)<span class="op">+</span>np.arange(<span class="dv">1</span>,<span class="dv">31</span>).astype(<span class="bu">str</span>)).isna().<span class="bu">sum</span>()[crowd_data.drop(columns<span class="op">=</span>np.array([<span class="st">"source_"</span>]<span class="op">*</span><span class="dv">30</span>)<span class="op">+</span>np.arange(<span class="dv">1</span>,<span class="dv">31</span>).astype(<span class="bu">str</span>)).isna().<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>location_detail       2749
macroevent           32293
actors                1220
valence                 10
size_text             6536
size_high               33
arrests               3927
injuries_crowd        3985
injuries_police       3973
property_damage       3956
chemical_agents      30723
notes                29202
lat                      2
lon                      2
resolved_locality      340
resolved_county       1923
resolved_state          10
dtype: int64</code></pre>
</div>
</div>
<div id="38c97631" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># source_cols = np.array(["source_"]*30) + np.arange(1,31).astype(str)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_data.drop(columns=source_cols, inplace=True)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_data.head(5)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_data["fips_code"] = crowd_data["fips_code"].astype(np.int16)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_data["fips_code"]</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>crowd_data[<span class="st">"year"</span>] <span class="op">=</span> crowd_data[<span class="st">"date"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x:x[:<span class="dv">4</span>]).astype(<span class="bu">int</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>crowd_data[<span class="st">"year"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\alexa\AppData\Local\Temp\ipykernel_37948\1221614407.py:7: SettingWithCopyWarning:


A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>2        2017
8        2017
13       2017
14       2017
16       2017
         ... 
72155    2020
72156    2020
72167    2020
72168    2020
72172    2020
Name: year, Length: 33467, dtype: int64</code></pre>
</div>
</div>
<p>Limit to the years 2017 and 2018</p>
<div id="9d02a57f" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>crowd_data <span class="op">=</span> crowd_data[(crowd_data[<span class="st">"year"</span>] <span class="op">==</span> <span class="dv">2017</span>) <span class="op">|</span> (crowd_data[<span class="st">"year"</span>] <span class="op">==</span> <span class="dv">2018</span>)]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Add column for <code>log_size_mean</code></p>
<div id="fb37f7f4" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>crowd_data[<span class="st">"log_size_mean"</span>] <span class="op">=</span> crowd_data[<span class="st">"size_mean"</span>].<span class="bu">apply</span>(np.log)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>crowd_data[<span class="st">"log_size_mean"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>2        0.693147
8        2.890372
13       5.298317
14       5.703782
16       0.693147
           ...   
32405    5.010635
32413    2.484907
32415    2.995732
32424    4.605170
32426    3.401197
Name: log_size_mean, Length: 16703, dtype: float64</code></pre>
</div>
</div>
<div id="7116e943" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(crowd_data[<span class="st">"fips_code"</span>].isna().<span class="bu">sum</span>(), <span class="st">"out of"</span>, <span class="bu">len</span>(crowd_data))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0 out of 16703</code></pre>
</div>
</div>
<p>0 unresolved localities out of 16764; we need not discard any data and may cast as string.</p>
<div id="7a0ee59f" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_data = crowd_data[crowd_data["fips_code"].notna()]</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>crowd_data[<span class="st">"fips_code"</span>] <span class="op">=</span> crowd_data[<span class="st">"fips_code"</span>].astype(<span class="bu">int</span>).astype(<span class="bu">str</span>).<span class="bu">str</span>.rjust(<span class="dv">5</span>,<span class="st">"0"</span>).astype(<span class="st">"category"</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>crowd_data[<span class="st">"fips_code"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>2        27053
8        12086
13       26161
14       38085
16       36061
         ...  
32405    37081
32413    01101
32415    17031
32424    30087
32426    39035
Name: fips_code, Length: 16703, dtype: category
Categories (1316, object): ['01003', '01007', '01015', '01041', ..., '56041', '66000', '72000', '78000']</code></pre>
</div>
</div>
<p>Reindex to requisite columns</p>
<div id="426e6abf" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>crowd_data <span class="op">=</span> crowd_data[[<span class="st">"year"</span>,<span class="st">"fips_code"</span>,<span class="st">"type"</span>,<span class="st">"issues"</span>,<span class="st">"claims"</span>,<span class="st">"size_mean"</span>, <span class="st">"log_size_mean"</span>, <span class="st">"size_cat"</span>]]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>crowd_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">fips_code</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">issues</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">size_mean</th>
<th data-quarto-table-cell-role="th">log_size_mean</th>
<th data-quarto-table-cell-role="th">size_cat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2017</td>
<td>27053</td>
<td>protest; banner drop</td>
<td>banking and finance; economy; energy; environment; indigenous peoples</td>
<td>against the Dakota Access Pipeline, for indigenous rights, for environment, pressure US Bank to divest from pipeline</td>
<td>2.0</td>
<td>0.693147</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>2017</td>
<td>12086</td>
<td>demonstration</td>
<td>policing</td>
<td>in remembrance of Jamal Rollins, against police brutality, for police transparency</td>
<td>18.0</td>
<td>2.890372</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>2017</td>
<td>26161</td>
<td>protest</td>
<td>education; racism</td>
<td>against racial incidents on campus, for pressuring university administration to do something, against racism</td>
<td>200.0</td>
<td>5.298317</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>2017</td>
<td>38085</td>
<td>protest; occupying land</td>
<td>energy; environment</td>
<td>for environmental rights, against Dakota Access Pipeline</td>
<td>300.0</td>
<td>5.703782</td>
<td>2</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>2017</td>
<td>36061</td>
<td>protest</td>
<td>presidency</td>
<td>against Trump's campaign and upcoming presidency</td>
<td>2.0</td>
<td>0.693147</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32405</th>
<td>2018</td>
<td>37081</td>
<td>protest</td>
<td>foreign affairs</td>
<td>in solidarity with the people of Sudan; against current Sudanese leader</td>
<td>150.0</td>
<td>5.010635</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32413</th>
<td>2018</td>
<td>01101</td>
<td>protest</td>
<td>policing; racism</td>
<td>protesting the shooting death of a black man by police</td>
<td>12.0</td>
<td>2.484907</td>
<td>1</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32415</th>
<td>2018</td>
<td>17031</td>
<td>protest</td>
<td>housing</td>
<td>protesting against the demolition of a historic home and apartment complex</td>
<td>20.0</td>
<td>2.995732</td>
<td>1</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32424</th>
<td>2018</td>
<td>30087</td>
<td>protest</td>
<td>women's rights</td>
<td>protesting to bring awareness to violence against native women</td>
<td>100.0</td>
<td>4.605170</td>
<td>2</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32426</th>
<td>2018</td>
<td>39035</td>
<td>protest</td>
<td>criminal justice</td>
<td>demanding changes inside the Cuyahoga County jail after inmate deaths</td>
<td>30.0</td>
<td>3.401197</td>
<td>1</td>
</tr>
</tbody>
</table>

<p>16703 rows × 8 columns</p>
</div>
</div>
</div>
<p>Correct mislabeled <code>type</code>s</p>
<div id="1cda7614" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>crowd_data_type <span class="op">=</span> crowd_data[<span class="st">"type"</span>].<span class="bu">str</span>.lower()<span class="co">#.str.replace(r"\s+", " ", regex=True)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>crowd_data_type_repl_dict <span class="op">=</span> {<span class="st">"nat'l"</span>:<span class="st">"national"</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">","</span>:<span class="st">";"</span>, <span class="st">"/"</span>:<span class="st">";"</span>, <span class="st">" and "</span>:<span class="st">";"</span>, <span class="st">"'"</span>:<span class="st">";"</span>, <span class="st">":"</span>:<span class="st">";"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"block highways"</span>:<span class="st">"block highway"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"counter-protest"</span>:<span class="st">"counterprotest"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"counterprotesting families belong together march"</span>:<span class="st">"counterprotest; march"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"demonstraton"</span>:<span class="st">"demonstration"</span>, <span class="st">"demonstation"</span>:<span class="st">"demonstration"</span>, <span class="st">"demonstrations"</span>:<span class="st">"demonstration"</span>, <span class="st">"demonstarion"</span>:<span class="st">"demonstration"</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"demonstratin"</span>:<span class="st">"demonstration"</span>, <span class="st">"deomnstration"</span>:<span class="st">"demonstration"</span>, <span class="st">"demonstartion"</span>:<span class="st">"demonstration"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"flashmob"</span>:<span class="st">"flash mob"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"marach"</span>:<span class="st">"march"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"protests"</span>:<span class="st">"protest"</span>, <span class="st">"protestors"</span>:<span class="st">"protest"</span>, <span class="st">"protesst"</span>:<span class="st">"protest"</span>, <span class="st">"protest0"</span>:<span class="st">"protest"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"protest hike"</span>:<span class="st">"protest; hike"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"protest resignation"</span>:<span class="st">"protest; resignation"</span>,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"protest (walk-out)"</span>:<span class="st">"protest; walk-out"</span>,</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"protest walk"</span>:<span class="st">"protest; walk"</span>,</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"raly"</span>:<span class="st">"rally"</span>, <span class="st">"rallies"</span>:<span class="st">"rally"</span>, <span class="st">"rallying"</span>:<span class="st">"rally"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"sit-in demonstration"</span>:<span class="st">"sit-in"</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"walk in"</span>:<span class="st">"walk-in"</span>,<span class="st">"walkin"</span>:<span class="st">"walk-in"</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"walk out"</span>:<span class="st">"walk-out"</span>, <span class="st">"walkout"</span>:<span class="st">"walk-out"</span>,<span class="st">"walkut"</span>:<span class="st">"walk-out"</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                             }</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> key, value <span class="kw">in</span> crowd_data_type_repl_dict.items():</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    crowd_data_type <span class="op">=</span> crowd_data_type.<span class="bu">str</span>.replace(key, value)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>crowd_data_type <span class="op">=</span> crowd_data_type.<span class="bu">str</span>.split(<span class="st">";"</span>).explode().astype(<span class="bu">str</span>).<span class="bu">str</span>.lstrip().<span class="bu">str</span>.rstrip()</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>crowd_data_type <span class="op">=</span> crowd_data_type.loc[(crowd_data_type <span class="op">!=</span> <span class="st">"nan"</span>) <span class="op">&amp;</span> (crowd_data_type <span class="op">!=</span> <span class="st">"m"</span>) <span class="op">&amp;</span> (crowd_data_type <span class="op">!=</span> <span class="st">"0.0"</span>)]</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>crowd_data_type.unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>array(['protest', 'banner drop', 'demonstration', 'occupying land',
       'strike', 'vigil', 'rally', 'direct action', 'march',
       'flag burning', 'block highway', 'sign held on crane',
       'counterprotest', 'sit-in', 'standoff', 'dance', 'blockade',
       'nonviolent blockade', 'road blockade', 'mass mooning',
       'kindness march', 'civil disobedience', 'walk-out',
       'human barricade', 'block streets', 'peace march',
       'protest (armed)', 'hunger strike', 'sick out', 'boycott',
       'swim protest', 'die-in', 'boycott classes', 'resignation',
       'turn backs to speaker', 'die in', 'art projection', 'sing-in',
       'skits', 'flash mob', 'flotilla', 'counter protest',
       'block interactions', 'light rail stop', 'superhero rally',
       'aircraft flyover', 'death train', 'street blockade', 'encampment',
       '"drive"', 'railroad blockade', 'pray-in', 'picket',
       'railway blockade', 'hike', 'festival', 'walk', 'dinner', 'event',
       'mass', 'parade', 'standout', 'protest vandalism',
       'silent protest', 'parents', 'support walk-out', 'walk-in',
       'postcard writing to public officials', 'science fair',
       'mock execution', 'teach in', 'on-campus discussion',
       'kayak protest', 'iftar', 'moment of silence', 'prayer rally',
       'self-immolation protest', 'convoy', 'kneeling protest',
       'procession', 'rent strike', 'hunger-strike', '"kookout"',
       'protest in trees', 'educational event',
       'kneeling during national anthem', 'non-partisan rally', 'demo',
       'speeches', 'drive by mar-a-lago', 'prayer vigil',
       'press conference', 'grade-strike'], dtype=object)</code></pre>
</div>
</div>
<div id="881667a8" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>crowd_data_orig[crowd_data_orig[<span class="st">"type"</span>]<span class="op">==</span><span class="st">"parents"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">locality</th>
<th data-quarto-table-cell-role="th">state</th>
<th data-quarto-table-cell-role="th">location_detail</th>
<th data-quarto-table-cell-role="th">online</th>
<th data-quarto-table-cell-role="th">type</th>
<th data-quarto-table-cell-role="th">macroevent</th>
<th data-quarto-table-cell-role="th">actors</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">source_28</th>
<th data-quarto-table-cell-role="th">source_29</th>
<th data-quarto-table-cell-role="th">source_30</th>
<th data-quarto-table-cell-role="th">notes</th>
<th data-quarto-table-cell-role="th">lat</th>
<th data-quarto-table-cell-role="th">lon</th>
<th data-quarto-table-cell-role="th">resolved_locality</th>
<th data-quarto-table-cell-role="th">resolved_county</th>
<th data-quarto-table-cell-role="th">resolved_state</th>
<th data-quarto-table-cell-role="th">fips_code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">13414</th>
<td>2018-03-01</td>
<td>Muskogee</td>
<td>OK</td>
<td>Muskogee High School</td>
<td>0.0</td>
<td>parents</td>
<td>NaN</td>
<td>teachers, students</td>
<td>Protesting low teacher pay</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>35.747877</td>
<td>-95.369691</td>
<td>Muskogee</td>
<td>Muskogee County</td>
<td>OK</td>
<td>40101.0</td>
</tr>
</tbody>
</table>

<p>1 rows × 62 columns</p>
</div>
</div>
</div>
<p>Onehot encode <code>type</code></p>
<div id="2ec05f5a" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>type_onehot <span class="op">=</span> pd.get_dummies(crowd_data_type, prefix<span class="op">=</span><span class="st">"type"</span>, drop_first<span class="op">=</span><span class="va">True</span>).groupby(crowd_data_type.index).<span class="bu">any</span>()</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># type_onehot</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>crowd_data <span class="op">=</span> crowd_data.drop(columns<span class="op">=</span><span class="st">"type"</span>).join(type_onehot)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>crowd_data <span class="op">=</span> crowd_data[crowd_data.notna().<span class="bu">all</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>crowd_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">fips_code</th>
<th data-quarto-table-cell-role="th">issues</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">size_mean</th>
<th data-quarto-table-cell-role="th">log_size_mean</th>
<th data-quarto-table-cell-role="th">size_cat</th>
<th data-quarto-table-cell-role="th">type_"kookout"</th>
<th data-quarto-table-cell-role="th">type_aircraft flyover</th>
<th data-quarto-table-cell-role="th">type_art projection</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">type_strike</th>
<th data-quarto-table-cell-role="th">type_superhero rally</th>
<th data-quarto-table-cell-role="th">type_support walk-out</th>
<th data-quarto-table-cell-role="th">type_swim protest</th>
<th data-quarto-table-cell-role="th">type_teach in</th>
<th data-quarto-table-cell-role="th">type_turn backs to speaker</th>
<th data-quarto-table-cell-role="th">type_vigil</th>
<th data-quarto-table-cell-role="th">type_walk</th>
<th data-quarto-table-cell-role="th">type_walk-in</th>
<th data-quarto-table-cell-role="th">type_walk-out</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2017</td>
<td>27053</td>
<td>banking and finance; economy; energy; environment; indigenous peoples</td>
<td>against the Dakota Access Pipeline, for indigenous rights, for environment, pressure US Bank to divest from pipeline</td>
<td>2.0</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>2017</td>
<td>12086</td>
<td>policing</td>
<td>in remembrance of Jamal Rollins, against police brutality, for police transparency</td>
<td>18.0</td>
<td>2.890372</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>2017</td>
<td>26161</td>
<td>education; racism</td>
<td>against racial incidents on campus, for pressuring university administration to do something, against racism</td>
<td>200.0</td>
<td>5.298317</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>2017</td>
<td>38085</td>
<td>energy; environment</td>
<td>for environmental rights, against Dakota Access Pipeline</td>
<td>300.0</td>
<td>5.703782</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>2017</td>
<td>36061</td>
<td>presidency</td>
<td>against Trump's campaign and upcoming presidency</td>
<td>2.0</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32405</th>
<td>2018</td>
<td>37081</td>
<td>foreign affairs</td>
<td>in solidarity with the people of Sudan; against current Sudanese leader</td>
<td>150.0</td>
<td>5.010635</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32413</th>
<td>2018</td>
<td>01101</td>
<td>policing; racism</td>
<td>protesting the shooting death of a black man by police</td>
<td>12.0</td>
<td>2.484907</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32415</th>
<td>2018</td>
<td>17031</td>
<td>housing</td>
<td>protesting against the demolition of a historic home and apartment complex</td>
<td>20.0</td>
<td>2.995732</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32424</th>
<td>2018</td>
<td>30087</td>
<td>women's rights</td>
<td>protesting to bring awareness to violence against native women</td>
<td>100.0</td>
<td>4.605170</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32426</th>
<td>2018</td>
<td>39035</td>
<td>criminal justice</td>
<td>demanding changes inside the Cuyahoga County jail after inmate deaths</td>
<td>30.0</td>
<td>3.401197</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>16701 rows × 99 columns</p>
</div>
</div>
</div>
<p>Type <code>size_cat</code> as category and <code>size_mean</code> as int</p>
<div id="544273ad" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>crowd_data[<span class="st">"size_cat"</span>] <span class="op">=</span> crowd_data[<span class="st">"size_cat"</span>].astype(<span class="st">"category"</span>).cat.as_ordered()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>crowd_data[<span class="st">"size_mean"</span>] <span class="op">=</span> crowd_data[<span class="st">"size_mean"</span>].astype(<span class="bu">int</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>crowd_data[[<span class="st">"size_cat"</span>,<span class="st">"size_mean"</span>]]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">size_cat</th>
<th data-quarto-table-cell-role="th">size_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>1</td>
<td>18</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>2</td>
<td>200</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>2</td>
<td>300</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32405</th>
<td>2</td>
<td>150</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32413</th>
<td>1</td>
<td>12</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32415</th>
<td>1</td>
<td>20</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32424</th>
<td>2</td>
<td>100</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32426</th>
<td>1</td>
<td>30</td>
</tr>
</tbody>
</table>

<p>16701 rows × 2 columns</p>
</div>
</div>
</div>
<p>Prepare <code>issues</code> for merging</p>
<div id="1570d6d3" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>crowd_data_problems <span class="op">=</span> pd.concat([crowd_data[<span class="st">"issues"</span>].<span class="bu">str</span>.split(<span class="st">"; "</span>),crowd_data[<span class="st">"year"</span>]],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>crowd_data_problems</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">issues</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>[banking and finance, economy, energy, environment, indigenous peoples]</td>
<td>2017</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>[policing]</td>
<td>2017</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>[education, racism]</td>
<td>2017</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>[energy, environment]</td>
<td>2017</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>[presidency]</td>
<td>2017</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32405</th>
<td>[foreign affairs]</td>
<td>2018</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32413</th>
<td>[policing, racism]</td>
<td>2018</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32415</th>
<td>[housing]</td>
<td>2018</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32424</th>
<td>[women's rights]</td>
<td>2018</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32426</th>
<td>[criminal justice]</td>
<td>2018</td>
</tr>
</tbody>
</table>

<p>16701 rows × 2 columns</p>
</div>
</div>
</div>
</section>
<section id="american-community-survey-1-year-estimates" class="level3">
<h3 class="anchored" data-anchor-id="american-community-survey-1-year-estimates">American Community Survey 1-Year Estimates</h3>
<div id="2493b340" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>api_key <span class="op">=</span> <span class="st">"29e7dfea2f8b253a0a10ccd9626f78e49f4f0a4f"</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> regex_filter(string, myregex):</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> string:</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        mo <span class="op">=</span> re.search(myregex, string)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mo:</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>census_vars_orig <span class="op">=</span> ced.variables.search(ACS1_PROFILE, <span class="dv">2017</span>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>census_vars <span class="op">=</span> census_vars_orig[(census_vars_orig[<span class="st">"GROUP"</span>] <span class="op">!=</span> <span class="st">"N/A"</span>)]</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>census_vars_pcts <span class="op">=</span> census_vars[census_vars[<span class="st">"VARIABLE"</span>].<span class="bu">apply</span>(regex_filter,myregex<span class="op">=</span><span class="vs">r"PE</span><span class="dv">$</span><span class="vs">"</span>)]</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>census_vars_pcts_no_ratio <span class="op">=</span> census_vars_pcts[<span class="op">~</span>census_vars_pcts[<span class="st">"LABEL"</span>].<span class="bu">apply</span>(regex_filter,myregex<span class="op">=</span><span class="vs">r"Sex</span><span class="dv">\s</span><span class="vs">ratio"</span>)]</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>census_vars_agg <span class="op">=</span> census_vars_pcts_no_ratio[census_vars_pcts_no_ratio[<span class="st">"LABEL"</span>].<span class="bu">apply</span>(regex_filter,myregex<span class="op">=</span><span class="vs">r"</span><span class="kw">(</span><span class="vs">Median</span><span class="kw">)</span><span class="cf">|</span><span class="kw">(</span><span class="vs">Mean</span><span class="kw">)</span><span class="cf">|</span><span class="kw">(</span><span class="vs">Average</span><span class="kw">)</span><span class="cf">|</span><span class="kw">(</span><span class="vs">Per</span><span class="dv">\s</span><span class="kw">)</span><span class="cf">|</span><span class="kw">(</span><span class="dv">\s</span><span class="vs">rate</span><span class="kw">)</span><span class="vs">"</span>)]</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="co"># census_vars_tot = census_vars_pcts_no_ratio[census_vars_pcts_no_ratio["LABEL"].apply(regex_filter,myregex=r"Total(?!.*\!\!)")]</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a><span class="co"># census_vars_tot[["VARIABLE","LABEL"]]</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>census_vars_agg[[<span class="st">"VARIABLE"</span>,<span class="st">"LABEL"</span>]]</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>census_vars_pcts_no_ratio_agg <span class="op">=</span> census_vars_pcts_no_ratio.drop(census_vars_agg.index)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>census_vars_agg_ests <span class="op">=</span> census_vars_agg[<span class="st">"VARIABLE"</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x:x.replace(<span class="st">"PE"</span>,<span class="st">"E"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="4b295f4e" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>census_vars_to_drop <span class="op">=</span> [<span class="st">"DP05_0033PE"</span>, <span class="co"># same as DP05_0001PE (Total Population)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"DP05_0105PE"</span>, <span class="co"># total housing units—replace with DP05_0105E, which is the same as DP04_0001PE</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"DP04_0006PE"</span>, <span class="co"># same as DP04_0001PE </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"DP04_0016PE"</span>, <span class="co"># same as DP04_0001PE </span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"DP04_0027PE"</span>, <span class="co"># same as DP04_0001PE </span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"DP04_0038PE"</span> <span class="co"># same as DP04_0001PE  </span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                       ]</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>census_vars_to_add <span class="op">=</span> []</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>census_vars_pcts_no_ratio_agg_drop <span class="op">=</span> census_vars_pcts_no_ratio_agg[<span class="st">"VARIABLE"</span>][<span class="op">~</span>census_vars_pcts_no_ratio_agg[<span class="st">"VARIABLE"</span>].isin(census_vars_to_drop)]</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>census_vars_final <span class="op">=</span> pd.concat([pd.Series([<span class="st">"NAME"</span>]), </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                               pd.concat([census_vars_pcts_no_ratio_agg_drop, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>                                          census_vars_agg_ests, </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>                                          pd.Series(census_vars_to_add)], </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                                         ignore_index<span class="op">=</span><span class="va">True</span>).sort_values()], </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                              ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>census_vars_final</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>0               NAME
1      DP02PR_0001PE
2      DP02PR_0002PE
3      DP02PR_0003PE
4      DP02PR_0004PE
           ...      
661      DP05_0085PE
662      DP05_0086PE
663      DP05_0087PE
664      DP05_0088PE
665      DP05_0089PE
Length: 666, dtype: object</code></pre>
</div>
</div>
<p>Solely request percents. The list of variables includes what should be the total population as a percent—<code>DP05_0001PE</code>—but, as that would always be 100%, the wise people at the US Census Bureau made such equal to <code>DP05_0001E</code>, the total population estimate, necessitating no further adjustment.</p>
<div id="ec5d6f5b" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>census_data <span class="op">=</span> [ced.download(ACS1_PROFILE, year, census_vars_final, </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                           metropolitan_statistical_area_micropolitan_statistical_area <span class="op">=</span><span class="st">"*"</span>, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                           api_key<span class="op">=</span>api_key</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                           ).set_index(<span class="st">"METROPOLITAN_STATISTICAL_AREA_MICROPOLITAN_STATISTICAL_AREA"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> year <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2017</span>,<span class="dv">2019</span>)]</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>census_data <span class="op">=</span> pd.concat(census_data, keys <span class="op">=</span> np.arange(<span class="dv">2017</span>,<span class="dv">2019</span>), names<span class="op">=</span>[<span class="st">"year"</span>])</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>census_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NAME</th>
<th data-quarto-table-cell-role="th">DP02PR_0001PE</th>
<th data-quarto-table-cell-role="th">DP02PR_0002PE</th>
<th data-quarto-table-cell-role="th">DP02PR_0003PE</th>
<th data-quarto-table-cell-role="th">DP02PR_0004PE</th>
<th data-quarto-table-cell-role="th">DP02PR_0005PE</th>
<th data-quarto-table-cell-role="th">DP02PR_0006PE</th>
<th data-quarto-table-cell-role="th">DP02PR_0007PE</th>
<th data-quarto-table-cell-role="th">DP02PR_0008PE</th>
<th data-quarto-table-cell-role="th">DP02PR_0009PE</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">DP05_0080PE</th>
<th data-quarto-table-cell-role="th">DP05_0081PE</th>
<th data-quarto-table-cell-role="th">DP05_0082PE</th>
<th data-quarto-table-cell-role="th">DP05_0083PE</th>
<th data-quarto-table-cell-role="th">DP05_0084PE</th>
<th data-quarto-table-cell-role="th">DP05_0085PE</th>
<th data-quarto-table-cell-role="th">DP05_0086PE</th>
<th data-quarto-table-cell-role="th">DP05_0087PE</th>
<th data-quarto-table-cell-role="th">DP05_0088PE</th>
<th data-quarto-table-cell-role="th">DP05_0089PE</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">METROPOLITAN_STATISTICAL_AREA_MICROPOLITAN_STATISTICAL_AREA</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th rowspan="5" data-quarto-table-cell-role="th" data-valign="top">2017</th>
<th data-quarto-table-cell-role="th">44220</th>
<td>Springfield, OH Metro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.7</td>
<td>0.0</td>
<td>0.2</td>
<td>3.5</td>
<td>0.0</td>
<td>3.5</td>
<td>NaN</td>
<td>103123</td>
<td>47.3</td>
<td>52.7</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">44300</th>
<td>State College, PA Metro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>6.8</td>
<td>0.0</td>
<td>0.0</td>
<td>1.2</td>
<td>0.2</td>
<td>1.0</td>
<td>NaN</td>
<td>129054</td>
<td>53.3</td>
<td>46.7</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">44340</th>
<td>Statesboro, GA Micro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>1.4</td>
<td>0.0</td>
<td>0.2</td>
<td>2.8</td>
<td>0.0</td>
<td>2.8</td>
<td>NaN</td>
<td>59095</td>
<td>48.5</td>
<td>51.5</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">44420</th>
<td>Staunton-Waynesboro, VA Metro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.6</td>
<td>0.0</td>
<td>0.1</td>
<td>1.1</td>
<td>0.0</td>
<td>1.1</td>
<td>NaN</td>
<td>95444</td>
<td>47.7</td>
<td>52.3</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">44620</th>
<td>Stevens Point, WI Micro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>3.3</td>
<td>0.0</td>
<td>0.0</td>
<td>1.3</td>
<td>0.1</td>
<td>1.2</td>
<td>NaN</td>
<td>55713</td>
<td>49.5</td>
<td>50.5</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th rowspan="5" data-quarto-table-cell-role="th" data-valign="top">2018</th>
<th data-quarto-table-cell-role="th">31820</th>
<td>Manitowoc, WI Micro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>2.8</td>
<td>0.0</td>
<td>0.0</td>
<td>1.1</td>
<td>0.0</td>
<td>1.1</td>
<td>NaN</td>
<td>61915</td>
<td>49.7</td>
<td>50.3</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">31860</th>
<td>Mankato-North Mankato, MN Metro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>1.9</td>
<td>0.1</td>
<td>0.0</td>
<td>2.4</td>
<td>0.0</td>
<td>2.4</td>
<td>NaN</td>
<td>78514</td>
<td>50.7</td>
<td>49.3</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">31900</th>
<td>Mansfield, OH Metro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.9</td>
<td>0.0</td>
<td>0.2</td>
<td>2.9</td>
<td>0.0</td>
<td>2.9</td>
<td>NaN</td>
<td>94217</td>
<td>50.5</td>
<td>49.5</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">31940</th>
<td>Marinette, WI-MI Micro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>0.3</td>
<td>0.0</td>
<td>0.0</td>
<td>2.0</td>
<td>0.0</td>
<td>2.0</td>
<td>NaN</td>
<td>51069</td>
<td>50.3</td>
<td>49.7</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">31980</th>
<td>Marion, IN Micro Area</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>51938</td>
<td>46.9</td>
<td>53.1</td>
</tr>
</tbody>
</table>

<p>1037 rows × 666 columns</p>
</div>
</div>
</div>
<p>As per Prof.&nbsp;Darcy Steeg Morris’ recommendation, to limit the columns to a reasonable number, all columns with any NAs will be eliminated.</p>
<div id="6e06ac6f" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>census_data <span class="op">=</span> census_data.drop(columns<span class="op">=</span>census_data.columns[census_data.isna().<span class="bu">any</span>()])</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>census_data.columns.size</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>209</code></pre>
</div>
</div>
<div id="881c21a9" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>census_data.columns</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>Index(['NAME', 'DP03_0025E', 'DP03_0046PE', 'DP03_0047PE', 'DP03_0048PE',
       'DP03_0049PE', 'DP03_0050PE', 'DP03_0051PE', 'DP03_0052PE',
       'DP03_0053PE',
       ...
       'DP05_0030PE', 'DP05_0031PE', 'DP05_0063PE', 'DP05_0064PE',
       'DP05_0070PE', 'DP05_0071PE', 'DP05_0076PE', 'DP05_0087PE',
       'DP05_0088PE', 'DP05_0089PE'],
      dtype='object', length=209)</code></pre>
</div>
</div>
</section>
<section id="most-important-problem-dataset-second-release-2024" class="level3">
<h3 class="anchored" data-anchor-id="most-important-problem-dataset-second-release-2024">Most Important Problem Dataset, Second Release (2024)</h3>
<p>The aggregated data may be found here: https://williamslaro.github.io/talks/dataset2. Previously, the individual data was used, necessitating much preprocessing.</p>
<div id="31110e9c" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>issue_data <span class="op">=</span> pd.read_csv(<span class="st">"C:</span><span class="ch">\\</span><span class="st">Users</span><span class="ch">\\</span><span class="st">alexa</span><span class="ch">\\</span><span class="st">Code</span><span class="ch">\\</span><span class="st">GW DATS</span><span class="ch">\\</span><span class="st">6103 12 Intro to Data Mining</span><span class="ch">\\</span><span class="st">Final Project</span><span class="ch">\\</span><span class="st">data</span><span class="ch">\\</span><span class="st">MIPD-2024-Aggregate</span><span class="ch">\\</span><span class="st">MIPDV2-All-year.csv"</span>,encoding<span class="op">=</span><span class="st">"ANSI"</span>,</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                         index_col<span class="op">=</span>[<span class="st">"year"</span>,<span class="st">"problem"</span>])</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>issue_data.head(<span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">cat</th>
<th data-quarto-table-cell-role="th">numsurveys</th>
<th data-quarto-table-cell-role="th">numrespondents</th>
<th data-quarto-table-cell-role="th">perc</th>
<th data-quarto-table-cell-role="th">catname</th>
<th data-quarto-table-cell-role="th">catdesc</th>
<th data-quarto-table-cell-role="th">problemname</th>
<th data-quarto-table-cell-role="th">problemdesc</th>
<th data-quarto-table-cell-role="th">problemissues</th>
<th data-quarto-table-cell-role="th">problemexamples</th>
<th data-quarto-table-cell-role="th">subname</th>
<th data-quarto-table-cell-role="th">ts</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">problem</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th rowspan="15" data-quarto-table-cell-role="th" data-valign="top">1939</th>
<th data-quarto-table-cell-role="th">1</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>45.401001</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Economy</td>
<td>includes all mentions of economic issues</td>
<td>Economy (general), unemployment, inflation, growth, monetary policy, domestic commerce, regulation, taxes, wages, industrial policy, etc</td>
<td>Jobs, cost of living, prices, interest rates, recession, prosperity, develop industry, bailouts, Wall Street, regulation, government control, wages, income, minimum wage, taxes, tax reform, labor, unions, strikes, automation</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>6.861000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Social Policy</td>
<td>includes all mentions of social policy</td>
<td>Social policy (general), welfare, education, health care, retirement, poverty, inequality, classes, homelessness, specific groups, etc</td>
<td>Government programs, welfare, entitlements, aid for the poor, schools, teachers, health care, medical care, prescription drugs, Social Security, the poor, economic inequality, class inequality, hunger, homeless shelters, refugees, elderly people, veterans, those with disabilities</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>0.200000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Rights</td>
<td>includes all mentions of civil and political rights</td>
<td>Gender rights, LGBTQ+ rights, reproductive rights, privacy rights, freedom, civil rights, racism/discrimination, non-violent political participation, etc</td>
<td>Sexual harassment, gender equality, wage gap, gay marriage, abortion rights, privacy, constitutional rights, freedoms, human rights, founding principles, religious freedom, busing, integration, fair employment, fair housing, fair treatment by police, voting rights, affirmative action, race relations, demonstrations, marches, protests</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">4</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>0.554000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Public Safety</td>
<td>includes all mentions of crime and public safety</td>
<td>Crime, law enforcement, gun control, drugs, alcohol/smoking, violence against women, political violence, etc</td>
<td>Crime, personal security, police, rule of law, criminal justice, police brutaility/violence, trust in police, Blue Lives Matter, criminal sentencing, prosecution, capital punishment, access to guns, Second Amendment, drug use and abuse, drug policy, alcohol, smoking, sexual abuse, domestic violence, disorder, riots, looting</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>4.629000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Fiscal Policy</td>
<td>includes all mentions of budgets and spending</td>
<td>Budget, debt, deficit, government spending, social spending, defense spending, space policy, agricultural policy, immigration policy, etc</td>
<td>Balance the budget, spending priorities, debt crisis, budget deficit, deficit spending, big government, size of government, social spending, welfare spending, military spending, space exploration, farmers, aid to farmers, immigration policy, border security, deportation, effects of immigration, immigrants receiving government assistance, treatment of immigrants</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">6</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>33.779999</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Foreign Policy</td>
<td>includes all mentions of foreign policy and other countries</td>
<td>Foreign policy, national security, nuclear weapons, terrorism, crises, war, foreign aid, world hunger, other countries/political actors, etc</td>
<td>Foreign affairs, international problems, foreign relations, take care of our own people, help allies, US position in the world, national security, defense, arms control, arms races, nuclear war, terrorism, Al-Qaeda, ISIS, specific crises and wars, too much aid going overseas, famine</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>0.056000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>International Economic Relations</td>
<td>includes all mentions of international economic exchange</td>
<td>Globalization, trade, international cooperation, other countries' economies, world economy, etc</td>
<td>Foreign ownership, foreign competition, trade relations, balance of trade, job losses due to trade, protection of US industry, trade agreements, United Nations, World Trade Organization, Asian financial crisis</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>0.044000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Environment</td>
<td>includes all mentions of the environment, natural resources and public health</td>
<td>Environment (general), climate change, pollution, energy sources, lack of natural resources, natural disasters, public health, etc</td>
<td>Environmental protection, conservation, climate change, global warming, litter, waste, air pollution, water pollution, energy crisis, oil, coal, gas, nuclear energy, alternative energy, fuel shortage, water shortage, weather, earthquakes, floods, AIDS, cancer, COVID</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">9</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>1.432000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Morality</td>
<td>includes all mentions of morals, values, and religious ideals</td>
<td>Morals and values, family values, religion, culture, abortion, church and state conflict, teen pregnancy, etc</td>
<td>Morals, values, ethics, honesty, family breakdown, divorce, lack of religion, sin, pornography, abortion, pro-life, school prayer, religion in politics, sex education</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">10</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>4.123000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Politics</td>
<td>includes all mentions of political leaders, values, ideology and institutions</td>
<td>Politics, corruption, trustworthiness, leadership, competence, representation and accountability, dishonesty, scandals, political process, ideology, institutions, specific actors, etc</td>
<td>Politics as usual, abuse of power, greedy politicians, lack of trust, integrity, government dysfunction, gridlock, obstruction, frustration with government, lack of responsiveness, government scandals, government reform, campaign finance, electoral college, term limits, two-party system, gerrymandering, conservativism, liberalism, American ideals, president, congress, courts, trust in science/experts</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">11</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>0.700000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Youth Issues</td>
<td>includes all mentions of youth issues</td>
<td>Youths (general), crime, gangs, school violence, employment, crimes against youths, etc</td>
<td>Children, morals for youths, juvenile delinquency, underage drinking, gangs, school shootings, jobs for youths, child labor, treatment of children</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">12</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>0.168000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Groups</td>
<td>includes all mentions of minority groups</td>
<td>Native Americans, hispanics, Asian Americans, Jews, Muslims</td>
<td>Minorities, American Indians, anti-semitism, Muslim fundamentalism</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>1.461000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Other and All</td>
<td>includes mentions of other problems or all problems</td>
<td>Other, all</td>
<td>Other, stress, stem cell research, computers and technology, suicide, social relations, animal rights</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>0.078000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>NaN</td>
<td>includes mentions of no problems</td>
<td>NaN</td>
<td>Nothing in particular, no other mention, no problem</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">15</th>
<td>1</td>
<td>3</td>
<td>8989</td>
<td>0.512000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Don't Know/Refused</td>
<td>includes any mention that is related to don't know or refusal</td>
<td>Don't know, no opinion, not applicable, refusal</td>
<td>Not sure, can't say, not interested, unknown, doesn't understand, no answer, no response, don’t care to answer</td>
<td>All</td>
<td>1939-01-01</td>
</tr>
<tr class="even">
<th rowspan="5" data-quarto-table-cell-role="th" data-valign="top">1940</th>
<th data-quarto-table-cell-role="th">1</th>
<td>1</td>
<td>1</td>
<td>2907</td>
<td>24.200001</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Economy</td>
<td>includes all mentions of economic issues</td>
<td>Economy (general), unemployment, inflation, growth, monetary policy, domestic commerce, regulation, taxes, wages, industrial policy, etc</td>
<td>Jobs, cost of living, prices, interest rates, recession, prosperity, develop industry, bailouts, Wall Street, regulation, government control, wages, income, minimum wage, taxes, tax reform, labor, unions, strikes, automation</td>
<td>All</td>
<td>1940-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>1</td>
<td>1</td>
<td>2907</td>
<td>3.474000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Social Policy</td>
<td>includes all mentions of social policy</td>
<td>Social policy (general), welfare, education, health care, retirement, poverty, inequality, classes, homelessness, specific groups, etc</td>
<td>Government programs, welfare, entitlements, aid for the poor, schools, teachers, health care, medical care, prescription drugs, Social Security, the poor, economic inequality, class inequality, hunger, homeless shelters, refugees, elderly people, veterans, those with disabilities</td>
<td>All</td>
<td>1940-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>1</td>
<td>1</td>
<td>2907</td>
<td>0.069000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Rights</td>
<td>includes all mentions of civil and political rights</td>
<td>Gender rights, LGBTQ+ rights, reproductive rights, privacy rights, freedom, civil rights, racism/discrimination, non-violent political participation, etc</td>
<td>Sexual harassment, gender equality, wage gap, gay marriage, abortion rights, privacy, constitutional rights, freedoms, human rights, founding principles, religious freedom, busing, integration, fair employment, fair housing, fair treatment by police, voting rights, affirmative action, race relations, demonstrations, marches, protests</td>
<td>All</td>
<td>1940-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>1</td>
<td>1</td>
<td>2907</td>
<td>0.172000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Public Safety</td>
<td>includes all mentions of crime and public safety</td>
<td>Crime, law enforcement, gun control, drugs, alcohol/smoking, violence against women, political violence, etc</td>
<td>Crime, personal security, police, rule of law, criminal justice, police brutaility/violence, trust in police, Blue Lives Matter, criminal sentencing, prosecution, capital punishment, access to guns, Second Amendment, drug use and abuse, drug policy, alcohol, smoking, sexual abuse, domestic violence, disorder, riots, looting</td>
<td>All</td>
<td>1940-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>1</td>
<td>1</td>
<td>2907</td>
<td>13.152000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Fiscal Policy</td>
<td>includes all mentions of budgets and spending</td>
<td>Budget, debt, deficit, government spending, social spending, defense spending, space policy, agricultural policy, immigration policy, etc</td>
<td>Balance the budget, spending priorities, debt crisis, budget deficit, deficit spending, big government, size of government, social spending, welfare spending, military spending, space exploration, farmers, aid to farmers, immigration policy, border security, deportation, effects of immigration, immigrants receiving government assistance, treatment of immigrants</td>
<td>All</td>
<td>1940-01-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Limit to relevant years</p>
<div id="f3cdc93d" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>issue_data <span class="op">=</span> issue_data.loc[[<span class="dv">2017</span>,<span class="dv">2018</span>]]</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>issue_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">cat</th>
<th data-quarto-table-cell-role="th">numsurveys</th>
<th data-quarto-table-cell-role="th">numrespondents</th>
<th data-quarto-table-cell-role="th">perc</th>
<th data-quarto-table-cell-role="th">catname</th>
<th data-quarto-table-cell-role="th">catdesc</th>
<th data-quarto-table-cell-role="th">problemname</th>
<th data-quarto-table-cell-role="th">problemdesc</th>
<th data-quarto-table-cell-role="th">problemissues</th>
<th data-quarto-table-cell-role="th">problemexamples</th>
<th data-quarto-table-cell-role="th">subname</th>
<th data-quarto-table-cell-role="th">ts</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">problem</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th rowspan="15" data-quarto-table-cell-role="th" data-valign="top">2017</th>
<th data-quarto-table-cell-role="th">1</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>19.669001</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Economy</td>
<td>includes all mentions of economic issues</td>
<td>Economy (general), unemployment, inflation, growth, monetary policy, domestic commerce, regulation, taxes, wages, industrial policy, etc</td>
<td>Jobs, cost of living, prices, interest rates, recession, prosperity, develop industry, bailouts, Wall Street, regulation, government control, wages, income, minimum wage, taxes, tax reform, labor, unions, strikes, automation</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>16.531000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Social Policy</td>
<td>includes all mentions of social policy</td>
<td>Social policy (general), welfare, education, health care, retirement, poverty, inequality, classes, homelessness, specific groups, etc</td>
<td>Government programs, welfare, entitlements, aid for the poor, schools, teachers, health care, medical care, prescription drugs, Social Security, the poor, economic inequality, class inequality, hunger, homeless shelters, refugees, elderly people, veterans, those with disabilities</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>4.969000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Rights</td>
<td>includes all mentions of civil and political rights</td>
<td>Gender rights, LGBTQ+ rights, reproductive rights, privacy rights, freedom, civil rights, racism/discrimination, non-violent political participation, etc</td>
<td>Sexual harassment, gender equality, wage gap, gay marriage, abortion rights, privacy, constitutional rights, freedoms, human rights, founding principles, religious freedom, busing, integration, fair employment, fair housing, fair treatment by police, voting rights, affirmative action, race relations, demonstrations, marches, protests</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">4</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>1.275000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Public Safety</td>
<td>includes all mentions of crime and public safety</td>
<td>Crime, law enforcement, gun control, drugs, alcohol/smoking, violence against women, political violence, etc</td>
<td>Crime, personal security, police, rule of law, criminal justice, police brutaility/violence, trust in police, Blue Lives Matter, criminal sentencing, prosecution, capital punishment, access to guns, Second Amendment, drug use and abuse, drug policy, alcohol, smoking, sexual abuse, domestic violence, disorder, riots, looting</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>15.047000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Fiscal Policy</td>
<td>includes all mentions of budgets and spending</td>
<td>Budget, debt, deficit, government spending, social spending, defense spending, space policy, agricultural policy, immigration policy, etc</td>
<td>Balance the budget, spending priorities, debt crisis, budget deficit, deficit spending, big government, size of government, social spending, welfare spending, military spending, space exploration, farmers, aid to farmers, immigration policy, border security, deportation, effects of immigration, immigrants receiving government assistance, treatment of immigrants</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">6</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>11.080000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Foreign Policy</td>
<td>includes all mentions of foreign policy and other countries</td>
<td>Foreign policy, national security, nuclear weapons, terrorism, crises, war, foreign aid, world hunger, other countries/political actors, etc</td>
<td>Foreign affairs, international problems, foreign relations, take care of our own people, help allies, US position in the world, national security, defense, arms control, arms races, nuclear war, terrorism, Al-Qaeda, ISIS, specific crises and wars, too much aid going overseas, famine</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>0.222000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>International Economic Relations</td>
<td>includes all mentions of international economic exchange</td>
<td>Globalization, trade, international cooperation, other countries' economies, world economy, etc</td>
<td>Foreign ownership, foreign competition, trade relations, balance of trade, job losses due to trade, protection of US industry, trade agreements, United Nations, World Trade Organization, Asian financial crisis</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>2.157000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Environment</td>
<td>includes all mentions of the environment, natural resources and public health</td>
<td>Environment (general), climate change, pollution, energy sources, lack of natural resources, natural disasters, public health, etc</td>
<td>Environmental protection, conservation, climate change, global warming, litter, waste, air pollution, water pollution, energy crisis, oil, coal, gas, nuclear energy, alternative energy, fuel shortage, water shortage, weather, earthquakes, floods, AIDS, cancer, COVID</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">9</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>5.814000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Morality</td>
<td>includes all mentions of morals, values, and religious ideals</td>
<td>Morals and values, family values, religion, culture, abortion, church and state conflict, teen pregnancy, etc</td>
<td>Morals, values, ethics, honesty, family breakdown, divorce, lack of religion, sin, pornography, abortion, pro-life, school prayer, religion in politics, sex education</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">10</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>14.678000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Politics</td>
<td>includes all mentions of political leaders, values, ideology and institutions</td>
<td>Politics, corruption, trustworthiness, leadership, competence, representation and accountability, dishonesty, scandals, political process, ideology, institutions, specific actors, etc</td>
<td>Politics as usual, abuse of power, greedy politicians, lack of trust, integrity, government dysfunction, gridlock, obstruction, frustration with government, lack of responsiveness, government scandals, government reform, campaign finance, electoral college, term limits, two-party system, gerrymandering, conservativism, liberalism, American ideals, president, congress, courts, trust in science/experts</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">11</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>0.426000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Youth Issues</td>
<td>includes all mentions of youth issues</td>
<td>Youths (general), crime, gangs, school violence, employment, crimes against youths, etc</td>
<td>Children, morals for youths, juvenile delinquency, underage drinking, gangs, school shootings, jobs for youths, child labor, treatment of children</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">12</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>0.000000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Groups</td>
<td>includes all mentions of minority groups</td>
<td>Native Americans, hispanics, Asian Americans, Jews, Muslims</td>
<td>Minorities, American Indians, anti-semitism, Muslim fundamentalism</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>3.186000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Other and All</td>
<td>includes mentions of other problems or all problems</td>
<td>Other, all</td>
<td>Other, stress, stem cell research, computers and technology, suicide, social relations, animal rights</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>0.269000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>NaN</td>
<td>includes mentions of no problems</td>
<td>NaN</td>
<td>Nothing in particular, no other mention, no problem</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">15</th>
<td>1</td>
<td>2</td>
<td>1999</td>
<td>4.676000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Don't Know/Refused</td>
<td>includes any mention that is related to don't know or refusal</td>
<td>Don't know, no opinion, not applicable, refusal</td>
<td>Not sure, can't say, not interested, unknown, doesn't understand, no answer, no response, don’t care to answer</td>
<td>All</td>
<td>2017-01-01</td>
</tr>
<tr class="even">
<th rowspan="15" data-quarto-table-cell-role="th" data-valign="top">2018</th>
<th data-quarto-table-cell-role="th">1</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>14.319000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Economy</td>
<td>includes all mentions of economic issues</td>
<td>Economy (general), unemployment, inflation, growth, monetary policy, domestic commerce, regulation, taxes, wages, industrial policy, etc</td>
<td>Jobs, cost of living, prices, interest rates, recession, prosperity, develop industry, bailouts, Wall Street, regulation, government control, wages, income, minimum wage, taxes, tax reform, labor, unions, strikes, automation</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>11.224000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Social Policy</td>
<td>includes all mentions of social policy</td>
<td>Social policy (general), welfare, education, health care, retirement, poverty, inequality, classes, homelessness, specific groups, etc</td>
<td>Government programs, welfare, entitlements, aid for the poor, schools, teachers, health care, medical care, prescription drugs, Social Security, the poor, economic inequality, class inequality, hunger, homeless shelters, refugees, elderly people, veterans, those with disabilities</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>8.407000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Rights</td>
<td>includes all mentions of civil and political rights</td>
<td>Gender rights, LGBTQ+ rights, reproductive rights, privacy rights, freedom, civil rights, racism/discrimination, non-violent political participation, etc</td>
<td>Sexual harassment, gender equality, wage gap, gay marriage, abortion rights, privacy, constitutional rights, freedoms, human rights, founding principles, religious freedom, busing, integration, fair employment, fair housing, fair treatment by police, voting rights, affirmative action, race relations, demonstrations, marches, protests</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>3.457000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Public Safety</td>
<td>includes all mentions of crime and public safety</td>
<td>Crime, law enforcement, gun control, drugs, alcohol/smoking, violence against women, political violence, etc</td>
<td>Crime, personal security, police, rule of law, criminal justice, police brutaility/violence, trust in police, Blue Lives Matter, criminal sentencing, prosecution, capital punishment, access to guns, Second Amendment, drug use and abuse, drug policy, alcohol, smoking, sexual abuse, domestic violence, disorder, riots, looting</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>15.009000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Fiscal Policy</td>
<td>includes all mentions of budgets and spending</td>
<td>Budget, debt, deficit, government spending, social spending, defense spending, space policy, agricultural policy, immigration policy, etc</td>
<td>Balance the budget, spending priorities, debt crisis, budget deficit, deficit spending, big government, size of government, social spending, welfare spending, military spending, space exploration, farmers, aid to farmers, immigration policy, border security, deportation, effects of immigration, immigrants receiving government assistance, treatment of immigrants</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>12.685000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Foreign Policy</td>
<td>includes all mentions of foreign policy and other countries</td>
<td>Foreign policy, national security, nuclear weapons, terrorism, crises, war, foreign aid, world hunger, other countries/political actors, etc</td>
<td>Foreign affairs, international problems, foreign relations, take care of our own people, help allies, US position in the world, national security, defense, arms control, arms races, nuclear war, terrorism, Al-Qaeda, ISIS, specific crises and wars, too much aid going overseas, famine</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>0.282000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>International Economic Relations</td>
<td>includes all mentions of international economic exchange</td>
<td>Globalization, trade, international cooperation, other countries' economies, world economy, etc</td>
<td>Foreign ownership, foreign competition, trade relations, balance of trade, job losses due to trade, protection of US industry, trade agreements, United Nations, World Trade Organization, Asian financial crisis</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>1.959000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Environment</td>
<td>includes all mentions of the environment, natural resources and public health</td>
<td>Environment (general), climate change, pollution, energy sources, lack of natural resources, natural disasters, public health, etc</td>
<td>Environmental protection, conservation, climate change, global warming, litter, waste, air pollution, water pollution, energy crisis, oil, coal, gas, nuclear energy, alternative energy, fuel shortage, water shortage, weather, earthquakes, floods, AIDS, cancer, COVID</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>5.000000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Morality</td>
<td>includes all mentions of morals, values, and religious ideals</td>
<td>Morals and values, family values, religion, culture, abortion, church and state conflict, teen pregnancy, etc</td>
<td>Morals, values, ethics, honesty, family breakdown, divorce, lack of religion, sin, pornography, abortion, pro-life, school prayer, religion in politics, sex education</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>17.754000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Politics</td>
<td>includes all mentions of political leaders, values, ideology and institutions</td>
<td>Politics, corruption, trustworthiness, leadership, competence, representation and accountability, dishonesty, scandals, political process, ideology, institutions, specific actors, etc</td>
<td>Politics as usual, abuse of power, greedy politicians, lack of trust, integrity, government dysfunction, gridlock, obstruction, frustration with government, lack of responsiveness, government scandals, government reform, campaign finance, electoral college, term limits, two-party system, gerrymandering, conservativism, liberalism, American ideals, president, congress, courts, trust in science/experts</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>0.707000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Youth Issues</td>
<td>includes all mentions of youth issues</td>
<td>Youths (general), crime, gangs, school violence, employment, crimes against youths, etc</td>
<td>Children, morals for youths, juvenile delinquency, underage drinking, gangs, school shootings, jobs for youths, child labor, treatment of children</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>0.000000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Groups</td>
<td>includes all mentions of minority groups</td>
<td>Native Americans, hispanics, Asian Americans, Jews, Muslims</td>
<td>Minorities, American Indians, anti-semitism, Muslim fundamentalism</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>4.345000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Other and All</td>
<td>includes mentions of other problems or all problems</td>
<td>Other, all</td>
<td>Other, stress, stem cell research, computers and technology, suicide, social relations, animal rights</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>0.125000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>NaN</td>
<td>includes mentions of no problems</td>
<td>NaN</td>
<td>Nothing in particular, no other mention, no problem</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>1</td>
<td>2</td>
<td>1983</td>
<td>4.728000</td>
<td>MIPD (General)</td>
<td>general problem categories in the MIPD</td>
<td>Don't Know/Refused</td>
<td>includes any mention that is related to don't know or refusal</td>
<td>Don't know, no opinion, not applicable, refusal</td>
<td>Not sure, can't say, not interested, unknown, doesn't understand, no answer, no response, don’t care to answer</td>
<td>All</td>
<td>2018-01-01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Limit to relevant columns</p>
<div id="e3c21f31" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>issue_data_problems <span class="op">=</span> issue_data[[<span class="st">"problemname"</span>,<span class="st">"problemdesc"</span>,<span class="st">"problemissues"</span>,<span class="st">"problemexamples"</span>,<span class="st">"perc"</span>]]</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>issue_data_problems</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">problemname</th>
<th data-quarto-table-cell-role="th">problemdesc</th>
<th data-quarto-table-cell-role="th">problemissues</th>
<th data-quarto-table-cell-role="th">problemexamples</th>
<th data-quarto-table-cell-role="th">perc</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">problem</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th rowspan="15" data-quarto-table-cell-role="th" data-valign="top">2017</th>
<th data-quarto-table-cell-role="th">1</th>
<td>Economy</td>
<td>includes all mentions of economic issues</td>
<td>Economy (general), unemployment, inflation, growth, monetary policy, domestic commerce, regulation, taxes, wages, industrial policy, etc</td>
<td>Jobs, cost of living, prices, interest rates, recession, prosperity, develop industry, bailouts, Wall Street, regulation, government control, wages, income, minimum wage, taxes, tax reform, labor, unions, strikes, automation</td>
<td>19.669001</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>Social Policy</td>
<td>includes all mentions of social policy</td>
<td>Social policy (general), welfare, education, health care, retirement, poverty, inequality, classes, homelessness, specific groups, etc</td>
<td>Government programs, welfare, entitlements, aid for the poor, schools, teachers, health care, medical care, prescription drugs, Social Security, the poor, economic inequality, class inequality, hunger, homeless shelters, refugees, elderly people, veterans, those with disabilities</td>
<td>16.531000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>Rights</td>
<td>includes all mentions of civil and political rights</td>
<td>Gender rights, LGBTQ+ rights, reproductive rights, privacy rights, freedom, civil rights, racism/discrimination, non-violent political participation, etc</td>
<td>Sexual harassment, gender equality, wage gap, gay marriage, abortion rights, privacy, constitutional rights, freedoms, human rights, founding principles, religious freedom, busing, integration, fair employment, fair housing, fair treatment by police, voting rights, affirmative action, race relations, demonstrations, marches, protests</td>
<td>4.969000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">4</th>
<td>Public Safety</td>
<td>includes all mentions of crime and public safety</td>
<td>Crime, law enforcement, gun control, drugs, alcohol/smoking, violence against women, political violence, etc</td>
<td>Crime, personal security, police, rule of law, criminal justice, police brutaility/violence, trust in police, Blue Lives Matter, criminal sentencing, prosecution, capital punishment, access to guns, Second Amendment, drug use and abuse, drug policy, alcohol, smoking, sexual abuse, domestic violence, disorder, riots, looting</td>
<td>1.275000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>Fiscal Policy</td>
<td>includes all mentions of budgets and spending</td>
<td>Budget, debt, deficit, government spending, social spending, defense spending, space policy, agricultural policy, immigration policy, etc</td>
<td>Balance the budget, spending priorities, debt crisis, budget deficit, deficit spending, big government, size of government, social spending, welfare spending, military spending, space exploration, farmers, aid to farmers, immigration policy, border security, deportation, effects of immigration, immigrants receiving government assistance, treatment of immigrants</td>
<td>15.047000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">6</th>
<td>Foreign Policy</td>
<td>includes all mentions of foreign policy and other countries</td>
<td>Foreign policy, national security, nuclear weapons, terrorism, crises, war, foreign aid, world hunger, other countries/political actors, etc</td>
<td>Foreign affairs, international problems, foreign relations, take care of our own people, help allies, US position in the world, national security, defense, arms control, arms races, nuclear war, terrorism, Al-Qaeda, ISIS, specific crises and wars, too much aid going overseas, famine</td>
<td>11.080000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7</th>
<td>International Economic Relations</td>
<td>includes all mentions of international economic exchange</td>
<td>Globalization, trade, international cooperation, other countries' economies, world economy, etc</td>
<td>Foreign ownership, foreign competition, trade relations, balance of trade, job losses due to trade, protection of US industry, trade agreements, United Nations, World Trade Organization, Asian financial crisis</td>
<td>0.222000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>Environment</td>
<td>includes all mentions of the environment, natural resources and public health</td>
<td>Environment (general), climate change, pollution, energy sources, lack of natural resources, natural disasters, public health, etc</td>
<td>Environmental protection, conservation, climate change, global warming, litter, waste, air pollution, water pollution, energy crisis, oil, coal, gas, nuclear energy, alternative energy, fuel shortage, water shortage, weather, earthquakes, floods, AIDS, cancer, COVID</td>
<td>2.157000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">9</th>
<td>Morality</td>
<td>includes all mentions of morals, values, and religious ideals</td>
<td>Morals and values, family values, religion, culture, abortion, church and state conflict, teen pregnancy, etc</td>
<td>Morals, values, ethics, honesty, family breakdown, divorce, lack of religion, sin, pornography, abortion, pro-life, school prayer, religion in politics, sex education</td>
<td>5.814000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">10</th>
<td>Politics</td>
<td>includes all mentions of political leaders, values, ideology and institutions</td>
<td>Politics, corruption, trustworthiness, leadership, competence, representation and accountability, dishonesty, scandals, political process, ideology, institutions, specific actors, etc</td>
<td>Politics as usual, abuse of power, greedy politicians, lack of trust, integrity, government dysfunction, gridlock, obstruction, frustration with government, lack of responsiveness, government scandals, government reform, campaign finance, electoral college, term limits, two-party system, gerrymandering, conservativism, liberalism, American ideals, president, congress, courts, trust in science/experts</td>
<td>14.678000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">11</th>
<td>Youth Issues</td>
<td>includes all mentions of youth issues</td>
<td>Youths (general), crime, gangs, school violence, employment, crimes against youths, etc</td>
<td>Children, morals for youths, juvenile delinquency, underage drinking, gangs, school shootings, jobs for youths, child labor, treatment of children</td>
<td>0.426000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">12</th>
<td>Groups</td>
<td>includes all mentions of minority groups</td>
<td>Native Americans, hispanics, Asian Americans, Jews, Muslims</td>
<td>Minorities, American Indians, anti-semitism, Muslim fundamentalism</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>Other and All</td>
<td>includes mentions of other problems or all problems</td>
<td>Other, all</td>
<td>Other, stress, stem cell research, computers and technology, suicide, social relations, animal rights</td>
<td>3.186000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>NaN</td>
<td>includes mentions of no problems</td>
<td>NaN</td>
<td>Nothing in particular, no other mention, no problem</td>
<td>0.269000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">15</th>
<td>Don't Know/Refused</td>
<td>includes any mention that is related to don't know or refusal</td>
<td>Don't know, no opinion, not applicable, refusal</td>
<td>Not sure, can't say, not interested, unknown, doesn't understand, no answer, no response, don’t care to answer</td>
<td>4.676000</td>
</tr>
<tr class="even">
<th rowspan="15" data-quarto-table-cell-role="th" data-valign="top">2018</th>
<th data-quarto-table-cell-role="th">1</th>
<td>Economy</td>
<td>includes all mentions of economic issues</td>
<td>Economy (general), unemployment, inflation, growth, monetary policy, domestic commerce, regulation, taxes, wages, industrial policy, etc</td>
<td>Jobs, cost of living, prices, interest rates, recession, prosperity, develop industry, bailouts, Wall Street, regulation, government control, wages, income, minimum wage, taxes, tax reform, labor, unions, strikes, automation</td>
<td>14.319000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Social Policy</td>
<td>includes all mentions of social policy</td>
<td>Social policy (general), welfare, education, health care, retirement, poverty, inequality, classes, homelessness, specific groups, etc</td>
<td>Government programs, welfare, entitlements, aid for the poor, schools, teachers, health care, medical care, prescription drugs, Social Security, the poor, economic inequality, class inequality, hunger, homeless shelters, refugees, elderly people, veterans, those with disabilities</td>
<td>11.224000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Rights</td>
<td>includes all mentions of civil and political rights</td>
<td>Gender rights, LGBTQ+ rights, reproductive rights, privacy rights, freedom, civil rights, racism/discrimination, non-violent political participation, etc</td>
<td>Sexual harassment, gender equality, wage gap, gay marriage, abortion rights, privacy, constitutional rights, freedoms, human rights, founding principles, religious freedom, busing, integration, fair employment, fair housing, fair treatment by police, voting rights, affirmative action, race relations, demonstrations, marches, protests</td>
<td>8.407000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Public Safety</td>
<td>includes all mentions of crime and public safety</td>
<td>Crime, law enforcement, gun control, drugs, alcohol/smoking, violence against women, political violence, etc</td>
<td>Crime, personal security, police, rule of law, criminal justice, police brutaility/violence, trust in police, Blue Lives Matter, criminal sentencing, prosecution, capital punishment, access to guns, Second Amendment, drug use and abuse, drug policy, alcohol, smoking, sexual abuse, domestic violence, disorder, riots, looting</td>
<td>3.457000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Fiscal Policy</td>
<td>includes all mentions of budgets and spending</td>
<td>Budget, debt, deficit, government spending, social spending, defense spending, space policy, agricultural policy, immigration policy, etc</td>
<td>Balance the budget, spending priorities, debt crisis, budget deficit, deficit spending, big government, size of government, social spending, welfare spending, military spending, space exploration, farmers, aid to farmers, immigration policy, border security, deportation, effects of immigration, immigrants receiving government assistance, treatment of immigrants</td>
<td>15.009000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Foreign Policy</td>
<td>includes all mentions of foreign policy and other countries</td>
<td>Foreign policy, national security, nuclear weapons, terrorism, crises, war, foreign aid, world hunger, other countries/political actors, etc</td>
<td>Foreign affairs, international problems, foreign relations, take care of our own people, help allies, US position in the world, national security, defense, arms control, arms races, nuclear war, terrorism, Al-Qaeda, ISIS, specific crises and wars, too much aid going overseas, famine</td>
<td>12.685000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>International Economic Relations</td>
<td>includes all mentions of international economic exchange</td>
<td>Globalization, trade, international cooperation, other countries' economies, world economy, etc</td>
<td>Foreign ownership, foreign competition, trade relations, balance of trade, job losses due to trade, protection of US industry, trade agreements, United Nations, World Trade Organization, Asian financial crisis</td>
<td>0.282000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Environment</td>
<td>includes all mentions of the environment, natural resources and public health</td>
<td>Environment (general), climate change, pollution, energy sources, lack of natural resources, natural disasters, public health, etc</td>
<td>Environmental protection, conservation, climate change, global warming, litter, waste, air pollution, water pollution, energy crisis, oil, coal, gas, nuclear energy, alternative energy, fuel shortage, water shortage, weather, earthquakes, floods, AIDS, cancer, COVID</td>
<td>1.959000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Morality</td>
<td>includes all mentions of morals, values, and religious ideals</td>
<td>Morals and values, family values, religion, culture, abortion, church and state conflict, teen pregnancy, etc</td>
<td>Morals, values, ethics, honesty, family breakdown, divorce, lack of religion, sin, pornography, abortion, pro-life, school prayer, religion in politics, sex education</td>
<td>5.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>Politics</td>
<td>includes all mentions of political leaders, values, ideology and institutions</td>
<td>Politics, corruption, trustworthiness, leadership, competence, representation and accountability, dishonesty, scandals, political process, ideology, institutions, specific actors, etc</td>
<td>Politics as usual, abuse of power, greedy politicians, lack of trust, integrity, government dysfunction, gridlock, obstruction, frustration with government, lack of responsiveness, government scandals, government reform, campaign finance, electoral college, term limits, two-party system, gerrymandering, conservativism, liberalism, American ideals, president, congress, courts, trust in science/experts</td>
<td>17.754000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>Youth Issues</td>
<td>includes all mentions of youth issues</td>
<td>Youths (general), crime, gangs, school violence, employment, crimes against youths, etc</td>
<td>Children, morals for youths, juvenile delinquency, underage drinking, gangs, school shootings, jobs for youths, child labor, treatment of children</td>
<td>0.707000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>Groups</td>
<td>includes all mentions of minority groups</td>
<td>Native Americans, hispanics, Asian Americans, Jews, Muslims</td>
<td>Minorities, American Indians, anti-semitism, Muslim fundamentalism</td>
<td>0.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>Other and All</td>
<td>includes mentions of other problems or all problems</td>
<td>Other, all</td>
<td>Other, stress, stem cell research, computers and technology, suicide, social relations, animal rights</td>
<td>4.345000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>NaN</td>
<td>includes mentions of no problems</td>
<td>NaN</td>
<td>Nothing in particular, no other mention, no problem</td>
<td>0.125000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>Don't Know/Refused</td>
<td>includes any mention that is related to don't know or refusal</td>
<td>Don't know, no opinion, not applicable, refusal</td>
<td>Not sure, can't say, not interested, unknown, doesn't understand, no answer, no response, don’t care to answer</td>
<td>4.728000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Set<code>problemname</code> as a categorical variable</p>
<div id="d809e400" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>issue_data_problems[<span class="st">"problemname"</span>] <span class="op">=</span> issue_data_problems[<span class="st">"problemname"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>issue_data_problems[<span class="st">"problemname"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\alexa\AppData\Local\Temp\ipykernel_37948\1646687161.py:1: SettingWithCopyWarning:


A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>year  problem
2017  1                                   Economy
      2                             Social Policy
      3                                    Rights
      4                             Public Safety
      5                             Fiscal Policy
      6                            Foreign Policy
      7          International Economic Relations
      8                               Environment
      9                                  Morality
      10                                 Politics
      11                             Youth Issues
      12                                   Groups
      13                            Other and All
      14                                      NaN
      15                       Don't Know/Refused
2018  1                                   Economy
      2                             Social Policy
      3                                    Rights
      4                             Public Safety
      5                             Fiscal Policy
      6                            Foreign Policy
      7          International Economic Relations
      8                               Environment
      9                                  Morality
      10                                 Politics
      11                             Youth Issues
      12                                   Groups
      13                            Other and All
      14                                      NaN
      15                       Don't Know/Refused
Name: problemname, dtype: category
Categories (14, object): ['Don't Know/Refused', 'Economy', 'Environment', 'Fiscal Policy', ..., 'Public Safety', 'Rights', 'Social Policy', 'Youth Issues']</code></pre>
</div>
</div>
</section>
<section id="merge-the-datasets" class="level3">
<h3 class="anchored" data-anchor-id="merge-the-datasets">Merge the Datasets</h3>
<section id="merge-crowd-and-issue-data" class="level4">
<h4 class="anchored" data-anchor-id="merge-crowd-and-issue-data">Merge Crowd and Issue Data</h4>
<p>Some crowds are gathered for issues that fit into multiple categories, organized in alphabetical order. If this is the case, how should they be merged?</p>
<div id="2d51ca80" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>crowd_data[<span class="st">"issues"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>2        banking and finance; economy; energy; environment; indigenous peoples
8                                                                     policing
13                                                           education; racism
14                                                         energy; environment
16                                                                  presidency
                                         ...                                  
32405                                                          foreign affairs
32413                                                         policing; racism
32415                                                                  housing
32424                                                           women's rights
32426                                                         criminal justice
Name: issues, Length: 16701, dtype: object</code></pre>
</div>
</div>
<p>Perhaps solely the issue with the highest salience should be accounted for? Or, perhaps, the pcts should be added, representing the salience of anyone interested in at least one of the issues?</p>
<p>“The percentages can therefore be interpreted as the percentage of the electorate who answered the question and selected that category.” -MIPDV2-Codebook p.&nbsp;5</p>
<p>The latter will be used.</p>
<div id="34445f38" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>crowd_data_problems <span class="op">=</span> crowd_data_problems.explode(column<span class="op">=</span><span class="st">"issues"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>crowd_data_problems[<span class="st">"issues"</span>].unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>array(['banking and finance', 'economy', 'energy', 'environment',
       'indigenous peoples', 'policing', 'education', 'racism',
       'presidency', "women's rights", 'democracy', 'judiciary', 'labor',
       'development', 'guns', 'immigration', 'healthcare',
       'criminal justice', 'legislative', 'reproductive rights',
       'lgbtqia', 'civil rights', 'animal rights', 'religion',
       'sexual violence', 'housing', 'transportation', 'foreign affairs',
       'taxes', 'science', 'patriotism', 'military', 'disability rights',
       'drugs', 'sports', 'free speech', 'corruption', 'covid'],
      dtype=object)</code></pre>
</div>
</div>
<p>All the issues in the CCC data. Each is to be mapped to a problem code in the MIPD data. This will be done by hand.</p>
<p>But why is <code>covid</code> there? This should be limited to the years 2017 and 18.</p>
<div id="03405a34" class="cell" data-execution_count="26">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>crowd_data[crowd_data[<span class="st">"issues"</span>].<span class="bu">str</span>.contains(<span class="st">"covid"</span>)].reindex(columns<span class="op">=</span>[<span class="st">"issues"</span>,<span class="st">"claims"</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">issues</th>
<th data-quarto-table-cell-role="th">claims</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">8278</th>
<td>covid; judiciary</td>
<td>Rally against court's decesion to reopen Rocky Flats</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">23918</th>
<td>covid; healthcare</td>
<td>Protesting CDC definition of lyme disease</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">26845</th>
<td>covid; immigration</td>
<td>against ICE; against reopening immigrant detention facility</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">26968</th>
<td>covid; energy</td>
<td>protesting reopening of Japanese nuclear power plants</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>According to the data dictionary, “These are generated after data compilation by running a series of regular expressions over the claims description text” (p.&nbsp;3). These claims all include the words “reopen”, “reopening”, or “CDC”; these are false positives. As such, <code>covid</code> will manually be removed from these four so as to not impact findings.</p>
<div id="87fd6e7b" class="cell" data-execution_count="27">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>crowd_data_problems <span class="op">=</span> crowd_data_problems[crowd_data_problems[<span class="st">"issues"</span>] <span class="op">!=</span> <span class="st">"covid"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Check again for unique issues:</p>
<div id="818cd5be" class="cell" data-execution_count="28">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>crowd_data_problems[<span class="st">"issues"</span>].unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>array(['banking and finance', 'economy', 'energy', 'environment',
       'indigenous peoples', 'policing', 'education', 'racism',
       'presidency', "women's rights", 'democracy', 'judiciary', 'labor',
       'development', 'guns', 'immigration', 'healthcare',
       'criminal justice', 'legislative', 'reproductive rights',
       'lgbtqia', 'civil rights', 'animal rights', 'religion',
       'sexual violence', 'housing', 'transportation', 'foreign affairs',
       'taxes', 'science', 'patriotism', 'military', 'disability rights',
       'drugs', 'sports', 'free speech', 'corruption'], dtype=object)</code></pre>
</div>
</div>
<div id="de9b6507" class="cell" data-execution_count="29">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>issue_data_problems</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">problemname</th>
<th data-quarto-table-cell-role="th">problemdesc</th>
<th data-quarto-table-cell-role="th">problemissues</th>
<th data-quarto-table-cell-role="th">problemexamples</th>
<th data-quarto-table-cell-role="th">perc</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">problem</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th rowspan="15" data-quarto-table-cell-role="th" data-valign="top">2017</th>
<th data-quarto-table-cell-role="th">1</th>
<td>Economy</td>
<td>includes all mentions of economic issues</td>
<td>Economy (general), unemployment, inflation, growth, monetary policy, domestic commerce, regulation, taxes, wages, industrial policy, etc</td>
<td>Jobs, cost of living, prices, interest rates, recession, prosperity, develop industry, bailouts, Wall Street, regulation, government control, wages, income, minimum wage, taxes, tax reform, labor, unions, strikes, automation</td>
<td>19.669001</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>Social Policy</td>
<td>includes all mentions of social policy</td>
<td>Social policy (general), welfare, education, health care, retirement, poverty, inequality, classes, homelessness, specific groups, etc</td>
<td>Government programs, welfare, entitlements, aid for the poor, schools, teachers, health care, medical care, prescription drugs, Social Security, the poor, economic inequality, class inequality, hunger, homeless shelters, refugees, elderly people, veterans, those with disabilities</td>
<td>16.531000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">3</th>
<td>Rights</td>
<td>includes all mentions of civil and political rights</td>
<td>Gender rights, LGBTQ+ rights, reproductive rights, privacy rights, freedom, civil rights, racism/discrimination, non-violent political participation, etc</td>
<td>Sexual harassment, gender equality, wage gap, gay marriage, abortion rights, privacy, constitutional rights, freedoms, human rights, founding principles, religious freedom, busing, integration, fair employment, fair housing, fair treatment by police, voting rights, affirmative action, race relations, demonstrations, marches, protests</td>
<td>4.969000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">4</th>
<td>Public Safety</td>
<td>includes all mentions of crime and public safety</td>
<td>Crime, law enforcement, gun control, drugs, alcohol/smoking, violence against women, political violence, etc</td>
<td>Crime, personal security, police, rule of law, criminal justice, police brutaility/violence, trust in police, Blue Lives Matter, criminal sentencing, prosecution, capital punishment, access to guns, Second Amendment, drug use and abuse, drug policy, alcohol, smoking, sexual abuse, domestic violence, disorder, riots, looting</td>
<td>1.275000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">5</th>
<td>Fiscal Policy</td>
<td>includes all mentions of budgets and spending</td>
<td>Budget, debt, deficit, government spending, social spending, defense spending, space policy, agricultural policy, immigration policy, etc</td>
<td>Balance the budget, spending priorities, debt crisis, budget deficit, deficit spending, big government, size of government, social spending, welfare spending, military spending, space exploration, farmers, aid to farmers, immigration policy, border security, deportation, effects of immigration, immigrants receiving government assistance, treatment of immigrants</td>
<td>15.047000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">6</th>
<td>Foreign Policy</td>
<td>includes all mentions of foreign policy and other countries</td>
<td>Foreign policy, national security, nuclear weapons, terrorism, crises, war, foreign aid, world hunger, other countries/political actors, etc</td>
<td>Foreign affairs, international problems, foreign relations, take care of our own people, help allies, US position in the world, national security, defense, arms control, arms races, nuclear war, terrorism, Al-Qaeda, ISIS, specific crises and wars, too much aid going overseas, famine</td>
<td>11.080000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">7</th>
<td>International Economic Relations</td>
<td>includes all mentions of international economic exchange</td>
<td>Globalization, trade, international cooperation, other countries' economies, world economy, etc</td>
<td>Foreign ownership, foreign competition, trade relations, balance of trade, job losses due to trade, protection of US industry, trade agreements, United Nations, World Trade Organization, Asian financial crisis</td>
<td>0.222000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>Environment</td>
<td>includes all mentions of the environment, natural resources and public health</td>
<td>Environment (general), climate change, pollution, energy sources, lack of natural resources, natural disasters, public health, etc</td>
<td>Environmental protection, conservation, climate change, global warming, litter, waste, air pollution, water pollution, energy crisis, oil, coal, gas, nuclear energy, alternative energy, fuel shortage, water shortage, weather, earthquakes, floods, AIDS, cancer, COVID</td>
<td>2.157000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">9</th>
<td>Morality</td>
<td>includes all mentions of morals, values, and religious ideals</td>
<td>Morals and values, family values, religion, culture, abortion, church and state conflict, teen pregnancy, etc</td>
<td>Morals, values, ethics, honesty, family breakdown, divorce, lack of religion, sin, pornography, abortion, pro-life, school prayer, religion in politics, sex education</td>
<td>5.814000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">10</th>
<td>Politics</td>
<td>includes all mentions of political leaders, values, ideology and institutions</td>
<td>Politics, corruption, trustworthiness, leadership, competence, representation and accountability, dishonesty, scandals, political process, ideology, institutions, specific actors, etc</td>
<td>Politics as usual, abuse of power, greedy politicians, lack of trust, integrity, government dysfunction, gridlock, obstruction, frustration with government, lack of responsiveness, government scandals, government reform, campaign finance, electoral college, term limits, two-party system, gerrymandering, conservativism, liberalism, American ideals, president, congress, courts, trust in science/experts</td>
<td>14.678000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">11</th>
<td>Youth Issues</td>
<td>includes all mentions of youth issues</td>
<td>Youths (general), crime, gangs, school violence, employment, crimes against youths, etc</td>
<td>Children, morals for youths, juvenile delinquency, underage drinking, gangs, school shootings, jobs for youths, child labor, treatment of children</td>
<td>0.426000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">12</th>
<td>Groups</td>
<td>includes all mentions of minority groups</td>
<td>Native Americans, hispanics, Asian Americans, Jews, Muslims</td>
<td>Minorities, American Indians, anti-semitism, Muslim fundamentalism</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>Other and All</td>
<td>includes mentions of other problems or all problems</td>
<td>Other, all</td>
<td>Other, stress, stem cell research, computers and technology, suicide, social relations, animal rights</td>
<td>3.186000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>NaN</td>
<td>includes mentions of no problems</td>
<td>NaN</td>
<td>Nothing in particular, no other mention, no problem</td>
<td>0.269000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">15</th>
<td>Don't Know/Refused</td>
<td>includes any mention that is related to don't know or refusal</td>
<td>Don't know, no opinion, not applicable, refusal</td>
<td>Not sure, can't say, not interested, unknown, doesn't understand, no answer, no response, don’t care to answer</td>
<td>4.676000</td>
</tr>
<tr class="even">
<th rowspan="15" data-quarto-table-cell-role="th" data-valign="top">2018</th>
<th data-quarto-table-cell-role="th">1</th>
<td>Economy</td>
<td>includes all mentions of economic issues</td>
<td>Economy (general), unemployment, inflation, growth, monetary policy, domestic commerce, regulation, taxes, wages, industrial policy, etc</td>
<td>Jobs, cost of living, prices, interest rates, recession, prosperity, develop industry, bailouts, Wall Street, regulation, government control, wages, income, minimum wage, taxes, tax reform, labor, unions, strikes, automation</td>
<td>14.319000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>Social Policy</td>
<td>includes all mentions of social policy</td>
<td>Social policy (general), welfare, education, health care, retirement, poverty, inequality, classes, homelessness, specific groups, etc</td>
<td>Government programs, welfare, entitlements, aid for the poor, schools, teachers, health care, medical care, prescription drugs, Social Security, the poor, economic inequality, class inequality, hunger, homeless shelters, refugees, elderly people, veterans, those with disabilities</td>
<td>11.224000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>Rights</td>
<td>includes all mentions of civil and political rights</td>
<td>Gender rights, LGBTQ+ rights, reproductive rights, privacy rights, freedom, civil rights, racism/discrimination, non-violent political participation, etc</td>
<td>Sexual harassment, gender equality, wage gap, gay marriage, abortion rights, privacy, constitutional rights, freedoms, human rights, founding principles, religious freedom, busing, integration, fair employment, fair housing, fair treatment by police, voting rights, affirmative action, race relations, demonstrations, marches, protests</td>
<td>8.407000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>Public Safety</td>
<td>includes all mentions of crime and public safety</td>
<td>Crime, law enforcement, gun control, drugs, alcohol/smoking, violence against women, political violence, etc</td>
<td>Crime, personal security, police, rule of law, criminal justice, police brutaility/violence, trust in police, Blue Lives Matter, criminal sentencing, prosecution, capital punishment, access to guns, Second Amendment, drug use and abuse, drug policy, alcohol, smoking, sexual abuse, domestic violence, disorder, riots, looting</td>
<td>3.457000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>Fiscal Policy</td>
<td>includes all mentions of budgets and spending</td>
<td>Budget, debt, deficit, government spending, social spending, defense spending, space policy, agricultural policy, immigration policy, etc</td>
<td>Balance the budget, spending priorities, debt crisis, budget deficit, deficit spending, big government, size of government, social spending, welfare spending, military spending, space exploration, farmers, aid to farmers, immigration policy, border security, deportation, effects of immigration, immigrants receiving government assistance, treatment of immigrants</td>
<td>15.009000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>Foreign Policy</td>
<td>includes all mentions of foreign policy and other countries</td>
<td>Foreign policy, national security, nuclear weapons, terrorism, crises, war, foreign aid, world hunger, other countries/political actors, etc</td>
<td>Foreign affairs, international problems, foreign relations, take care of our own people, help allies, US position in the world, national security, defense, arms control, arms races, nuclear war, terrorism, Al-Qaeda, ISIS, specific crises and wars, too much aid going overseas, famine</td>
<td>12.685000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>International Economic Relations</td>
<td>includes all mentions of international economic exchange</td>
<td>Globalization, trade, international cooperation, other countries' economies, world economy, etc</td>
<td>Foreign ownership, foreign competition, trade relations, balance of trade, job losses due to trade, protection of US industry, trade agreements, United Nations, World Trade Organization, Asian financial crisis</td>
<td>0.282000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>Environment</td>
<td>includes all mentions of the environment, natural resources and public health</td>
<td>Environment (general), climate change, pollution, energy sources, lack of natural resources, natural disasters, public health, etc</td>
<td>Environmental protection, conservation, climate change, global warming, litter, waste, air pollution, water pollution, energy crisis, oil, coal, gas, nuclear energy, alternative energy, fuel shortage, water shortage, weather, earthquakes, floods, AIDS, cancer, COVID</td>
<td>1.959000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>Morality</td>
<td>includes all mentions of morals, values, and religious ideals</td>
<td>Morals and values, family values, religion, culture, abortion, church and state conflict, teen pregnancy, etc</td>
<td>Morals, values, ethics, honesty, family breakdown, divorce, lack of religion, sin, pornography, abortion, pro-life, school prayer, religion in politics, sex education</td>
<td>5.000000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>Politics</td>
<td>includes all mentions of political leaders, values, ideology and institutions</td>
<td>Politics, corruption, trustworthiness, leadership, competence, representation and accountability, dishonesty, scandals, political process, ideology, institutions, specific actors, etc</td>
<td>Politics as usual, abuse of power, greedy politicians, lack of trust, integrity, government dysfunction, gridlock, obstruction, frustration with government, lack of responsiveness, government scandals, government reform, campaign finance, electoral college, term limits, two-party system, gerrymandering, conservativism, liberalism, American ideals, president, congress, courts, trust in science/experts</td>
<td>17.754000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>Youth Issues</td>
<td>includes all mentions of youth issues</td>
<td>Youths (general), crime, gangs, school violence, employment, crimes against youths, etc</td>
<td>Children, morals for youths, juvenile delinquency, underage drinking, gangs, school shootings, jobs for youths, child labor, treatment of children</td>
<td>0.707000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>Groups</td>
<td>includes all mentions of minority groups</td>
<td>Native Americans, hispanics, Asian Americans, Jews, Muslims</td>
<td>Minorities, American Indians, anti-semitism, Muslim fundamentalism</td>
<td>0.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>Other and All</td>
<td>includes mentions of other problems or all problems</td>
<td>Other, all</td>
<td>Other, stress, stem cell research, computers and technology, suicide, social relations, animal rights</td>
<td>4.345000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>NaN</td>
<td>includes mentions of no problems</td>
<td>NaN</td>
<td>Nothing in particular, no other mention, no problem</td>
<td>0.125000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>Don't Know/Refused</td>
<td>includes any mention that is related to don't know or refusal</td>
<td>Don't know, no opinion, not applicable, refusal</td>
<td>Not sure, can't say, not interested, unknown, doesn't understand, no answer, no response, don’t care to answer</td>
<td>4.728000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="e6263eb0" class="cell" data-execution_count="30">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>issue_code_dict <span class="op">=</span> {<span class="st">'animal rights'</span>:<span class="dv">13</span>, </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'banking and finance'</span>:<span class="dv">1</span>, </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'civil rights'</span>:<span class="dv">3</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'corruption'</span>:<span class="dv">10</span>, </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'criminal justice'</span>:<span class="dv">3</span>, </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'democracy'</span>:<span class="dv">10</span>,</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'development'</span>:<span class="dv">1</span>, </span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'disability rights'</span>:<span class="dv">3</span>, </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'drugs'</span>:<span class="dv">4</span>, </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'economy'</span>:<span class="dv">1</span>,</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'education'</span>:<span class="dv">2</span>, </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'energy'</span>:<span class="dv">8</span>, </span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'environment'</span>:<span class="dv">8</span>, </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'foreign affairs'</span>:<span class="dv">6</span>,</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'free speech'</span>:<span class="dv">3</span>, </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'guns'</span>:<span class="dv">4</span>, </span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'healthcare'</span>:<span class="dv">2</span>, </span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'housing'</span>:<span class="dv">2</span>, </span>
<span id="cb46-19"><a href="#cb46-19" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'immigration'</span>:<span class="dv">5</span>,</span>
<span id="cb46-20"><a href="#cb46-20" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'indigenous peoples'</span>:<span class="dv">12</span>, </span>
<span id="cb46-21"><a href="#cb46-21" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'judiciary'</span>:<span class="dv">10</span>, </span>
<span id="cb46-22"><a href="#cb46-22" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'labor'</span>:<span class="dv">1</span>, </span>
<span id="cb46-23"><a href="#cb46-23" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'legislative'</span>:<span class="dv">10</span>,</span>
<span id="cb46-24"><a href="#cb46-24" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'lgbtqia'</span>:<span class="dv">3</span>, </span>
<span id="cb46-25"><a href="#cb46-25" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'military'</span>:<span class="dv">6</span>, </span>
<span id="cb46-26"><a href="#cb46-26" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'patriotism'</span>:<span class="dv">9</span>, </span>
<span id="cb46-27"><a href="#cb46-27" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'policing'</span>:<span class="dv">3</span>,</span>
<span id="cb46-28"><a href="#cb46-28" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'presidency'</span>:<span class="dv">10</span>,</span>
<span id="cb46-29"><a href="#cb46-29" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'racism'</span>:<span class="dv">3</span>, </span>
<span id="cb46-30"><a href="#cb46-30" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'religion'</span>:<span class="dv">9</span>, </span>
<span id="cb46-31"><a href="#cb46-31" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'reproductive rights'</span>:<span class="dv">3</span>, </span>
<span id="cb46-32"><a href="#cb46-32" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'science'</span>:<span class="dv">10</span>,</span>
<span id="cb46-33"><a href="#cb46-33" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'sexual violence'</span>:<span class="dv">4</span>, </span>
<span id="cb46-34"><a href="#cb46-34" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'sports'</span>:<span class="dv">13</span>, </span>
<span id="cb46-35"><a href="#cb46-35" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'taxes'</span>:<span class="dv">1</span>, </span>
<span id="cb46-36"><a href="#cb46-36" aria-hidden="true" tabindex="-1"></a>                   <span class="st">'transportation'</span>:<span class="dv">2</span>,</span>
<span id="cb46-37"><a href="#cb46-37" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"women's rights"</span>:<span class="dv">3</span></span>
<span id="cb46-38"><a href="#cb46-38" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="d1e6cbb8" class="cell" data-execution_count="31">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>crowd_data_problems[<span class="st">"issues"</span>] <span class="op">=</span> crowd_data_problems[<span class="st">"issues"</span>].<span class="bu">apply</span>(np.vectorize(<span class="kw">lambda</span> x:issue_code_dict[x]))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>crowd_data_problems_to_merge <span class="op">=</span> crowd_data_problems.reset_index().drop_duplicates() <span class="co"># neccessary to ensure lines with different indexes aren't deleted</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>crowd_data_problems_to_merge</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">issues</th>
<th data-quarto-table-cell-role="th">year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2</td>
<td>1</td>
<td>2017</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">2</th>
<td>2</td>
<td>8</td>
<td>2017</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2</td>
<td>12</td>
<td>2017</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>8</td>
<td>3</td>
<td>2017</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>13</td>
<td>2</td>
<td>2017</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25901</th>
<td>32405</td>
<td>6</td>
<td>2018</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25902</th>
<td>32413</td>
<td>3</td>
<td>2018</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25904</th>
<td>32415</td>
<td>2</td>
<td>2018</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">25905</th>
<td>32424</td>
<td>3</td>
<td>2018</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">25906</th>
<td>32426</td>
<td>3</td>
<td>2018</td>
</tr>
</tbody>
</table>

<p>24851 rows × 3 columns</p>
</div>
</div>
</div>
<p>Now, this may be merged with the issue data.</p>
<p>We want to keep the index, however, so that we may group by it later.</p>
<div id="f3e1d6e3" class="cell" data-execution_count="32">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>crowd_problems_data_exploded <span class="op">=</span> crowd_data_problems_to_merge.merge(issue_data_problems[[<span class="st">"perc"</span>,<span class="st">"problemname"</span>]], how<span class="op">=</span><span class="st">"inner"</span>, left_on<span class="op">=</span>[<span class="st">"year"</span>,<span class="st">"issues"</span>], right_on<span class="op">=</span>[<span class="st">"year"</span>,<span class="st">"problem"</span>])</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>crowd_problems_data_exploded</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th">issues</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">perc</th>
<th data-quarto-table-cell-role="th">problemname</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2</td>
<td>1</td>
<td>2017</td>
<td>19.669001</td>
<td>Economy</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2</td>
<td>8</td>
<td>2017</td>
<td>2.157000</td>
<td>Environment</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2</td>
<td>12</td>
<td>2017</td>
<td>0.000000</td>
<td>Groups</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>8</td>
<td>3</td>
<td>2017</td>
<td>4.969000</td>
<td>Rights</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>13</td>
<td>2</td>
<td>2017</td>
<td>16.531000</td>
<td>Social Policy</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">24846</th>
<td>32405</td>
<td>6</td>
<td>2018</td>
<td>12.685000</td>
<td>Foreign Policy</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">24847</th>
<td>32413</td>
<td>3</td>
<td>2018</td>
<td>8.407000</td>
<td>Rights</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">24848</th>
<td>32415</td>
<td>2</td>
<td>2018</td>
<td>11.224000</td>
<td>Social Policy</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">24849</th>
<td>32424</td>
<td>3</td>
<td>2018</td>
<td>8.407000</td>
<td>Rights</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">24850</th>
<td>32426</td>
<td>3</td>
<td>2018</td>
<td>8.407000</td>
<td>Rights</td>
</tr>
</tbody>
</table>

<p>24851 rows × 5 columns</p>
</div>
</div>
</div>
<p>Remove unused categories.</p>
<div id="c7b40c64" class="cell" data-execution_count="33">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>crowd_problems_data_exploded[<span class="st">"problemname"</span>] <span class="op">=</span> crowd_problems_data_exploded[<span class="st">"problemname"</span>].cat.remove_unused_categories()</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>crowd_problems_data_exploded[<span class="st">"problemname"</span>].unique()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>['Economy', 'Environment', 'Groups', 'Rights', 'Social Policy', ..., 'Public Safety', 'Fiscal Policy', 'Other and All', 'Morality', 'Foreign Policy']
Length: 11
Categories (11, object): ['Economy', 'Environment', 'Fiscal Policy', 'Foreign Policy', ..., 'Politics', 'Public Safety', 'Rights', 'Social Policy']</code></pre>
</div>
</div>
<div id="d9f9d6b4" class="cell" data-execution_count="34">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>problems_onehot_to_group <span class="op">=</span> pd.get_dummies(crowd_problems_data_exploded[[<span class="st">"index"</span>,<span class="st">"problemname"</span>,<span class="st">"perc"</span>]],columns<span class="op">=</span>[<span class="st">"problemname"</span>]).drop(columns<span class="op">=</span><span class="st">"problemname_Other and All"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>problems_onehot_cols <span class="op">=</span> np.setdiff1d(problems_onehot_to_group.columns,[<span class="st">"perc"</span>,<span class="st">"index"</span>])</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>problems_onehot_grouped <span class="op">=</span> problems_onehot_to_group.groupby(by<span class="op">=</span><span class="st">"index"</span>).agg({<span class="st">"perc"</span>:<span class="st">"sum"</span>} <span class="op">|</span> <span class="bu">dict</span>(<span class="bu">zip</span>(problems_onehot_cols,[<span class="st">"any"</span>]<span class="op">*</span><span class="bu">len</span>(problems_onehot_cols))))</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>problems_onehot_grouped</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_problems_perc = crowd_data.drop(columns="type").join(type_onehot)</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_problems_perc</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="34">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">perc</th>
<th data-quarto-table-cell-role="th">problemname_Economy</th>
<th data-quarto-table-cell-role="th">problemname_Environment</th>
<th data-quarto-table-cell-role="th">problemname_Fiscal Policy</th>
<th data-quarto-table-cell-role="th">problemname_Foreign Policy</th>
<th data-quarto-table-cell-role="th">problemname_Groups</th>
<th data-quarto-table-cell-role="th">problemname_Morality</th>
<th data-quarto-table-cell-role="th">problemname_Politics</th>
<th data-quarto-table-cell-role="th">problemname_Public Safety</th>
<th data-quarto-table-cell-role="th">problemname_Rights</th>
<th data-quarto-table-cell-role="th">problemname_Social Policy</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">index</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>21.826001</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>4.969000</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>21.500000</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>2.157000</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>14.678000</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32405</th>
<td>12.685000</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32413</th>
<td>8.407000</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32415</th>
<td>11.224000</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32424</th>
<td>8.407000</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32426</th>
<td>8.407000</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>16701 rows × 11 columns</p>
</div>
</div>
</div>
<div id="6efc9381" class="cell" data-execution_count="35">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_problems_data_exploded_to_group = crowd_problems_data_exploded[["index","problemname","perc"]]</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># # crowd_problems_data_exploded_to_group</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_problems_perc = crowd_problems_data_exploded_to_group.groupby(by="index").agg({"perc":sum,"problemname":list})</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># crowd_problems_perc</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Lastly, merge back with original data.</p>
<div id="dccbbb2f" class="cell" data-execution_count="36">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>crowd_problems_data <span class="op">=</span> crowd_data.merge(problems_onehot_grouped, how<span class="op">=</span><span class="st">"inner"</span>, left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>crowd_problems_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">fips_code</th>
<th data-quarto-table-cell-role="th">issues</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">size_mean</th>
<th data-quarto-table-cell-role="th">log_size_mean</th>
<th data-quarto-table-cell-role="th">size_cat</th>
<th data-quarto-table-cell-role="th">type_"kookout"</th>
<th data-quarto-table-cell-role="th">type_aircraft flyover</th>
<th data-quarto-table-cell-role="th">type_art projection</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">problemname_Economy</th>
<th data-quarto-table-cell-role="th">problemname_Environment</th>
<th data-quarto-table-cell-role="th">problemname_Fiscal Policy</th>
<th data-quarto-table-cell-role="th">problemname_Foreign Policy</th>
<th data-quarto-table-cell-role="th">problemname_Groups</th>
<th data-quarto-table-cell-role="th">problemname_Morality</th>
<th data-quarto-table-cell-role="th">problemname_Politics</th>
<th data-quarto-table-cell-role="th">problemname_Public Safety</th>
<th data-quarto-table-cell-role="th">problemname_Rights</th>
<th data-quarto-table-cell-role="th">problemname_Social Policy</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2017</td>
<td>27053</td>
<td>banking and finance; economy; energy; environment; indigenous peoples</td>
<td>against the Dakota Access Pipeline, for indigenous rights, for environment, pressure US Bank to divest from pipeline</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>True</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">8</th>
<td>2017</td>
<td>12086</td>
<td>policing</td>
<td>in remembrance of Jamal Rollins, against police brutality, for police transparency</td>
<td>18</td>
<td>2.890372</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">13</th>
<td>2017</td>
<td>26161</td>
<td>education; racism</td>
<td>against racial incidents on campus, for pressuring university administration to do something, against racism</td>
<td>200</td>
<td>5.298317</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14</th>
<td>2017</td>
<td>38085</td>
<td>energy; environment</td>
<td>for environmental rights, against Dakota Access Pipeline</td>
<td>300</td>
<td>5.703782</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>2017</td>
<td>36061</td>
<td>presidency</td>
<td>against Trump's campaign and upcoming presidency</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32405</th>
<td>2018</td>
<td>37081</td>
<td>foreign affairs</td>
<td>in solidarity with the people of Sudan; against current Sudanese leader</td>
<td>150</td>
<td>5.010635</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32413</th>
<td>2018</td>
<td>01101</td>
<td>policing; racism</td>
<td>protesting the shooting death of a black man by police</td>
<td>12</td>
<td>2.484907</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32415</th>
<td>2018</td>
<td>17031</td>
<td>housing</td>
<td>protesting against the demolition of a historic home and apartment complex</td>
<td>20</td>
<td>2.995732</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">32424</th>
<td>2018</td>
<td>30087</td>
<td>women's rights</td>
<td>protesting to bring awareness to violence against native women</td>
<td>100</td>
<td>4.605170</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">32426</th>
<td>2018</td>
<td>39035</td>
<td>criminal justice</td>
<td>demanding changes inside the Cuyahoga County jail after inmate deaths</td>
<td>30</td>
<td>3.401197</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>16701 rows × 110 columns</p>
</div>
</div>
</div>
</section>
<section id="merge-with-census-data" class="level4">
<h4 class="anchored" data-anchor-id="merge-with-census-data">Merge with Census Data</h4>
<div id="8f69ac0d" class="cell" data-execution_count="37">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>cbsa_fips_crosswalk <span class="op">=</span> pd.read_excel(<span class="st">"C:</span><span class="ch">\\</span><span class="st">Users</span><span class="ch">\\</span><span class="st">alexa</span><span class="ch">\\</span><span class="st">Code</span><span class="ch">\\</span><span class="st">GW DATS</span><span class="ch">\\</span><span class="st">6103 12 Intro to Data Mining</span><span class="ch">\\</span><span class="st">Final Project</span><span class="ch">\\</span><span class="st">data</span><span class="ch">\\</span><span class="st">list1_2023.xlsx"</span>,skiprows<span class="op">=</span><span class="dv">2</span>,dtype<span class="op">=</span><span class="bu">str</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>cbsa_fips_crosswalk.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">CBSA Code</th>
<th data-quarto-table-cell-role="th">Metropolitan Division Code</th>
<th data-quarto-table-cell-role="th">CSA Code</th>
<th data-quarto-table-cell-role="th">CBSA Title</th>
<th data-quarto-table-cell-role="th">Metropolitan/Micropolitan Statistical Area</th>
<th data-quarto-table-cell-role="th">Metropolitan Division Title</th>
<th data-quarto-table-cell-role="th">CSA Title</th>
<th data-quarto-table-cell-role="th">County/County Equivalent</th>
<th data-quarto-table-cell-role="th">State Name</th>
<th data-quarto-table-cell-role="th">FIPS State Code</th>
<th data-quarto-table-cell-role="th">FIPS County Code</th>
<th data-quarto-table-cell-role="th">Central/Outlying County</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>10100</td>
<td>NaN</td>
<td>NaN</td>
<td>Aberdeen, SD</td>
<td>Micropolitan Statistical Area</td>
<td>NaN</td>
<td>NaN</td>
<td>Brown County</td>
<td>South Dakota</td>
<td>46</td>
<td>013</td>
<td>Central</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>10100</td>
<td>NaN</td>
<td>NaN</td>
<td>Aberdeen, SD</td>
<td>Micropolitan Statistical Area</td>
<td>NaN</td>
<td>NaN</td>
<td>Edmunds County</td>
<td>South Dakota</td>
<td>46</td>
<td>045</td>
<td>Outlying</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>10140</td>
<td>NaN</td>
<td>NaN</td>
<td>Aberdeen, WA</td>
<td>Micropolitan Statistical Area</td>
<td>NaN</td>
<td>NaN</td>
<td>Grays Harbor County</td>
<td>Washington</td>
<td>53</td>
<td>027</td>
<td>Central</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>10180</td>
<td>NaN</td>
<td>101</td>
<td>Abilene, TX</td>
<td>Metropolitan Statistical Area</td>
<td>NaN</td>
<td>Abilene-Sweetwater, TX</td>
<td>Callahan County</td>
<td>Texas</td>
<td>48</td>
<td>059</td>
<td>Outlying</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>10180</td>
<td>NaN</td>
<td>101</td>
<td>Abilene, TX</td>
<td>Metropolitan Statistical Area</td>
<td>NaN</td>
<td>Abilene-Sweetwater, TX</td>
<td>Jones County</td>
<td>Texas</td>
<td>48</td>
<td>253</td>
<td>Outlying</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="62fb5b57" class="cell" data-execution_count="38">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>cbsa_fips_crosswalk[<span class="st">"FIPS Code"</span>] <span class="op">=</span> cbsa_fips_crosswalk[<span class="st">"FIPS State Code"</span>] <span class="op">+</span> cbsa_fips_crosswalk[<span class="st">"FIPS County Code"</span>]</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>cbsa_fips_crosswalk[<span class="st">"FIPS Code"</span>] <span class="op">=</span> cbsa_fips_crosswalk[<span class="st">"FIPS Code"</span>].astype(<span class="st">"category"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Set all variables as categoricals.</p>
<div id="b0e5182f" class="cell" data-execution_count="39">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>cbsa_fips_crosswalk[<span class="st">"FIPS Code"</span>] <span class="op">=</span> cbsa_fips_crosswalk[<span class="st">"FIPS Code"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>cbsa_fips_crosswalk[<span class="st">"CBSA Code"</span>] <span class="op">=</span> cbsa_fips_crosswalk[<span class="st">"CBSA Code"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>cbsa_fips_crosswalk[<span class="st">"FIPS State Code"</span>] <span class="op">=</span> cbsa_fips_crosswalk[<span class="st">"FIPS State Code"</span>].astype(<span class="st">"category"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Drop NaN FIPS codes in preparation for merging.</p>
<div id="9166cbd5" class="cell" data-execution_count="40">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>cbsa_fips_crosswalk <span class="op">=</span> cbsa_fips_crosswalk[cbsa_fips_crosswalk[<span class="st">"FIPS Code"</span>].notna()]</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>cbsa_fips_crosswalk[<span class="st">"FIPS Code"</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>0       46013
1       46045
2       53027
3       48059
4       48253
        ...  
1910    06101
1911    06115
1912    04027
1913    39119
1914    48505
Name: FIPS Code, Length: 1915, dtype: category
Categories (1915, object): ['01001', '01003', '01005', '01007', ..., '72145', '72149', '72151', '72153']</code></pre>
</div>
</div>
<div id="99ab302d" class="cell" data-execution_count="41">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>crowd_problems_cbsa_data <span class="op">=</span> crowd_problems_data.merge(cbsa_fips_crosswalk[[<span class="st">"FIPS Code"</span>, <span class="st">"CBSA Code"</span>, <span class="st">"FIPS State Code"</span>]], </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                                                     how<span class="op">=</span><span class="st">"inner"</span>, left_on<span class="op">=</span><span class="st">"fips_code"</span>, right_on<span class="op">=</span><span class="st">"FIPS Code"</span>).drop(columns<span class="op">=</span><span class="st">"fips_code"</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>crowd_problems_cbsa_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">issues</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">size_mean</th>
<th data-quarto-table-cell-role="th">log_size_mean</th>
<th data-quarto-table-cell-role="th">size_cat</th>
<th data-quarto-table-cell-role="th">type_"kookout"</th>
<th data-quarto-table-cell-role="th">type_aircraft flyover</th>
<th data-quarto-table-cell-role="th">type_art projection</th>
<th data-quarto-table-cell-role="th">type_banner drop</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">problemname_Foreign Policy</th>
<th data-quarto-table-cell-role="th">problemname_Groups</th>
<th data-quarto-table-cell-role="th">problemname_Morality</th>
<th data-quarto-table-cell-role="th">problemname_Politics</th>
<th data-quarto-table-cell-role="th">problemname_Public Safety</th>
<th data-quarto-table-cell-role="th">problemname_Rights</th>
<th data-quarto-table-cell-role="th">problemname_Social Policy</th>
<th data-quarto-table-cell-role="th">FIPS Code</th>
<th data-quarto-table-cell-role="th">CBSA Code</th>
<th data-quarto-table-cell-role="th">FIPS State Code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2017</td>
<td>banking and finance; economy; energy; environment; indigenous peoples</td>
<td>against the Dakota Access Pipeline, for indigenous rights, for environment, pressure US Bank to divest from pipeline</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>...</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>27053</td>
<td>33460</td>
<td>27</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2017</td>
<td>policing</td>
<td>in remembrance of Jamal Rollins, against police brutality, for police transparency</td>
<td>18</td>
<td>2.890372</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>12086</td>
<td>33100</td>
<td>12</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2017</td>
<td>education; racism</td>
<td>against racial incidents on campus, for pressuring university administration to do something, against racism</td>
<td>200</td>
<td>5.298317</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>26161</td>
<td>11460</td>
<td>26</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2017</td>
<td>presidency</td>
<td>against Trump's campaign and upcoming presidency</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>36061</td>
<td>35620</td>
<td>36</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2017</td>
<td>presidency</td>
<td>against the certification of president-elect Trump</td>
<td>3</td>
<td>1.098612</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>11001</td>
<td>47900</td>
<td>11</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">15831</th>
<td>2018</td>
<td>education; racism</td>
<td>protesting against a confederate monument on the campus</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>True</td>
<td>37135</td>
<td>20500</td>
<td>37</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15832</th>
<td>2018</td>
<td>foreign affairs</td>
<td>in solidarity with the people of Sudan; against current Sudanese leader</td>
<td>150</td>
<td>5.010635</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>37081</td>
<td>24660</td>
<td>37</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">15833</th>
<td>2018</td>
<td>policing; racism</td>
<td>protesting the shooting death of a black man by police</td>
<td>12</td>
<td>2.484907</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>01101</td>
<td>33860</td>
<td>01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15834</th>
<td>2018</td>
<td>housing</td>
<td>protesting against the demolition of a historic home and apartment complex</td>
<td>20</td>
<td>2.995732</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>17031</td>
<td>16980</td>
<td>17</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">15835</th>
<td>2018</td>
<td>criminal justice</td>
<td>demanding changes inside the Cuyahoga County jail after inmate deaths</td>
<td>30</td>
<td>3.401197</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>39035</td>
<td>17410</td>
<td>39</td>
</tr>
</tbody>
</table>

<p>15836 rows × 112 columns</p>
</div>
</div>
</div>
<div id="bb969bf3" class="cell" data-execution_count="42">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>demo_data <span class="op">=</span> crowd_problems_cbsa_data.merge(census_data, how<span class="op">=</span><span class="st">"inner"</span>, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                                           left_on <span class="op">=</span> [<span class="st">"year"</span>,<span class="st">"CBSA Code"</span>], right_on <span class="op">=</span> [<span class="st">"year"</span>,<span class="st">"METROPOLITAN_STATISTICAL_AREA_MICROPOLITAN_STATISTICAL_AREA"</span>])</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>demo_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">issues</th>
<th data-quarto-table-cell-role="th">claims</th>
<th data-quarto-table-cell-role="th">size_mean</th>
<th data-quarto-table-cell-role="th">log_size_mean</th>
<th data-quarto-table-cell-role="th">size_cat</th>
<th data-quarto-table-cell-role="th">type_"kookout"</th>
<th data-quarto-table-cell-role="th">type_aircraft flyover</th>
<th data-quarto-table-cell-role="th">type_art projection</th>
<th data-quarto-table-cell-role="th">type_banner drop</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">DP05_0030PE</th>
<th data-quarto-table-cell-role="th">DP05_0031PE</th>
<th data-quarto-table-cell-role="th">DP05_0063PE</th>
<th data-quarto-table-cell-role="th">DP05_0064PE</th>
<th data-quarto-table-cell-role="th">DP05_0070PE</th>
<th data-quarto-table-cell-role="th">DP05_0071PE</th>
<th data-quarto-table-cell-role="th">DP05_0076PE</th>
<th data-quarto-table-cell-role="th">DP05_0087PE</th>
<th data-quarto-table-cell-role="th">DP05_0088PE</th>
<th data-quarto-table-cell-role="th">DP05_0089PE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2017</td>
<td>banking and finance; economy; energy; environment; indigenous peoples</td>
<td>against the Dakota Access Pipeline, for indigenous rights, for environment, pressure US Bank to divest from pipeline</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>...</td>
<td>44.5</td>
<td>55.5</td>
<td>3600618</td>
<td>81.3</td>
<td>3600618</td>
<td>5.9</td>
<td>94.1</td>
<td>2591001</td>
<td>49.0</td>
<td>51.0</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2017</td>
<td>policing</td>
<td>in remembrance of Jamal Rollins, against police brutality, for police transparency</td>
<td>18</td>
<td>2.890372</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>43.1</td>
<td>56.9</td>
<td>6158824</td>
<td>72.2</td>
<td>6158824</td>
<td>45.3</td>
<td>54.7</td>
<td>3924471</td>
<td>47.4</td>
<td>52.6</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2017</td>
<td>education; racism</td>
<td>against racial incidents on campus, for pressuring university administration to do something, against racism</td>
<td>200</td>
<td>5.298317</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>44.8</td>
<td>55.2</td>
<td>367627</td>
<td>77.7</td>
<td>367627</td>
<td>4.7</td>
<td>95.3</td>
<td>278978</td>
<td>49.2</td>
<td>50.8</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2017</td>
<td>presidency</td>
<td>against Trump's campaign and upcoming presidency</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>42.2</td>
<td>57.8</td>
<td>20320876</td>
<td>59.9</td>
<td>20320876</td>
<td>24.6</td>
<td>75.4</td>
<td>13563604</td>
<td>47.2</td>
<td>52.8</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2017</td>
<td>presidency</td>
<td>against the certification of president-elect Trump</td>
<td>3</td>
<td>1.098612</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>43.9</td>
<td>56.1</td>
<td>6216710</td>
<td>56.3</td>
<td>6216710</td>
<td>15.8</td>
<td>84.2</td>
<td>4155063</td>
<td>48.2</td>
<td>51.8</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14827</th>
<td>2018</td>
<td>presidency</td>
<td>anti-Trump; "Trump Rat" float near Mar-a-Lago</td>
<td>1</td>
<td>0.000000</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>43.1</td>
<td>56.9</td>
<td>6198782</td>
<td>71.5</td>
<td>6198782</td>
<td>45.8</td>
<td>54.2</td>
<td>3988782</td>
<td>47.4</td>
<td>52.6</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14828</th>
<td>2018</td>
<td>education; racism</td>
<td>protesting against a confederate monument on the campus</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>43.4</td>
<td>56.6</td>
<td>575412</td>
<td>65.2</td>
<td>575412</td>
<td>11.6</td>
<td>88.4</td>
<td>416987</td>
<td>46.7</td>
<td>53.3</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14829</th>
<td>2018</td>
<td>foreign affairs</td>
<td>in solidarity with the people of Sudan; against current Sudanese leader</td>
<td>150</td>
<td>5.010635</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>43.3</td>
<td>56.7</td>
<td>767711</td>
<td>64.9</td>
<td>767711</td>
<td>8.6</td>
<td>91.4</td>
<td>558753</td>
<td>46.4</td>
<td>53.6</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14830</th>
<td>2018</td>
<td>policing; racism</td>
<td>protesting the shooting death of a black man by police</td>
<td>12</td>
<td>2.484907</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>42.2</td>
<td>57.8</td>
<td>373401</td>
<td>50.6</td>
<td>373401</td>
<td>3.1</td>
<td>96.9</td>
<td>279570</td>
<td>46.6</td>
<td>53.4</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14831</th>
<td>2018</td>
<td>housing</td>
<td>protesting against the demolition of a historic home and apartment complex</td>
<td>20</td>
<td>2.995732</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>43.3</td>
<td>56.7</td>
<td>9497790</td>
<td>68.4</td>
<td>9497790</td>
<td>22.4</td>
<td>77.6</td>
<td>6589474</td>
<td>48.0</td>
<td>52.0</td>
</tr>
</tbody>
</table>

<p>14832 rows × 321 columns</p>
</div>
</div>
</div>
<div id="b4ed1c21" class="cell" data-execution_count="43">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>demo_data.columns[demo_data.isna().<span class="bu">any</span>()]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>Index([], dtype='object')</code></pre>
</div>
</div>
<p>The data has no NAs. We may proceed with modeling.</p>
<div id="d2b7d9f8" class="cell" data-execution_count="44">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># demo_data_clean_na_cols = demo_data_clean.columns[demo_data_clean.isna().sum() &gt; 0]</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># demo_data_clean_na_dict = dict(zip(demo_data_clean_na_cols,</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                    demo_data_clean[demo_data_clean_na_cols].mean()))</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="co"># demo_data_clean_na_dict</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="a62bc0e2" class="cell" data-execution_count="45">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># demo_data_clean = demo_data_clean.fillna(demo_data_clean_na_dict)</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (demo_data_clean.isna().sum() &gt; 0).any()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>One final step to preprocess: eliminate unused categories, then one-hot encode <code>CBSA Code</code>, <code>FIPS Code</code>, and <code>FIPS State Code</code> and eliminate all other string variables. As before, avoid multicollinearity.</p>
<div id="d12c72d1" class="cell" data-execution_count="46">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>demo_data[<span class="st">"CBSA Code"</span>] <span class="op">=</span> demo_data[<span class="st">"CBSA Code"</span>].astype(<span class="st">"category"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>demo_data[<span class="st">"FIPS Code"</span>] <span class="op">=</span> demo_data[<span class="st">"FIPS Code"</span>].cat.remove_unused_categories()</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>demo_data[<span class="st">"FIPS State Code"</span>] <span class="op">=</span> demo_data[<span class="st">"FIPS State Code"</span>].cat.remove_unused_categories()</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>demo_data_preprocessed <span class="op">=</span> pd.get_dummies(demo_data, columns<span class="op">=</span>[<span class="st">"CBSA Code"</span>,<span class="st">"FIPS Code"</span>,<span class="st">"FIPS State Code"</span>], drop_first<span class="op">=</span><span class="va">True</span>).drop(columns<span class="op">=</span>[<span class="st">"issues"</span>,<span class="st">"claims"</span>,<span class="st">"NAME"</span>])</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>demo_data_preprocessed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">size_mean</th>
<th data-quarto-table-cell-role="th">log_size_mean</th>
<th data-quarto-table-cell-role="th">size_cat</th>
<th data-quarto-table-cell-role="th">type_"kookout"</th>
<th data-quarto-table-cell-role="th">type_aircraft flyover</th>
<th data-quarto-table-cell-role="th">type_art projection</th>
<th data-quarto-table-cell-role="th">type_banner drop</th>
<th data-quarto-table-cell-role="th">type_block highway</th>
<th data-quarto-table-cell-role="th">type_block interactions</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">FIPS State Code_46</th>
<th data-quarto-table-cell-role="th">FIPS State Code_47</th>
<th data-quarto-table-cell-role="th">FIPS State Code_48</th>
<th data-quarto-table-cell-role="th">FIPS State Code_49</th>
<th data-quarto-table-cell-role="th">FIPS State Code_50</th>
<th data-quarto-table-cell-role="th">FIPS State Code_51</th>
<th data-quarto-table-cell-role="th">FIPS State Code_53</th>
<th data-quarto-table-cell-role="th">FIPS State Code_54</th>
<th data-quarto-table-cell-role="th">FIPS State Code_55</th>
<th data-quarto-table-cell-role="th">FIPS State Code_56</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>2017</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>True</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>2017</td>
<td>18</td>
<td>2.890372</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>2017</td>
<td>200</td>
<td>5.298317</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>2017</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>2017</td>
<td>3</td>
<td>1.098612</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14827</th>
<td>2018</td>
<td>1</td>
<td>0.000000</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14828</th>
<td>2018</td>
<td>2</td>
<td>0.693147</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14829</th>
<td>2018</td>
<td>150</td>
<td>5.010635</td>
<td>2</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">14830</th>
<td>2018</td>
<td>12</td>
<td>2.484907</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14831</th>
<td>2018</td>
<td>20</td>
<td>2.995732</td>
<td>1</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>...</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
<td>False</td>
</tr>
</tbody>
</table>

<p>14832 rows × 1672 columns</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="modeling" class="level2">
<h2 class="anchored" data-anchor-id="modeling">Modeling</h2>
<p>Prepare train and test datasets</p>
<div id="c26a2b38" class="cell" data-execution_count="47">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>target_cont <span class="op">=</span> <span class="st">"log_size_mean"</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>target_cat <span class="op">=</span> <span class="st">"size_cat"</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>targets <span class="op">=</span> [target_cont, target_cat, <span class="st">"size_mean"</span>]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>demo_train, demo_test <span class="op">=</span> train_test_split(demo_data_preprocessed, </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                                         train_size<span class="op">=</span><span class="fl">0.8</span>, </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>                                         random_state<span class="op">=</span>seed,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>                                         stratify<span class="op">=</span>demo_data_preprocessed[target_cat])</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                                         </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="co"># reset the index</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>demo_train, demo_test <span class="op">=</span> demo_train.reset_index(drop<span class="op">=</span><span class="va">True</span>), demo_test.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> np.setdiff1d(demo_train.columns, targets)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> demo_train[feature_names].values</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> demo_test[feature_names].values</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Target</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>y_train_cont <span class="op">=</span> demo_train[target_cont].values</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>y_test_cont <span class="op">=</span> demo_test[target_cont].values</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>y_train_cat <span class="op">=</span> demo_train[target_cat].values</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>y_test_cat <span class="op">=</span> demo_test[target_cat].values</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Standardize the features</p>
<div id="24bf9045" class="cell" data-execution_count="48">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ss <span class="op">=</span> StandardScaler()</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="co"># training data</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>X_train <span class="op">=</span> ss.fit_transform(X_train)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="co"># test data</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>X_test <span class="op">=</span> ss.transform(X_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="regression" class="level3">
<h3 class="anchored" data-anchor-id="regression">Regression</h3>
<div id="4ab288bd" class="cell" data-execution_count="49">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># problemname_cols = demo_data.columns.str.startswith("problemname")</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="co"># demo_data_one_problem = demo_data_clean[demo_data_clean["issues"].apply(lambda x:len(x) == 1)]</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># demo_data_one_problem["one_problem"] = demo_data_one_problem["issues"].apply(lambda x:x[0])</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sns.boxplot(x = 'problemname', y = target_cont, </span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co">#             hue = 'problemname',  </span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="co">#             data = demo_data)</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="8de595f5" class="cell" data-execution_count="50">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>sns.lmplot(x <span class="op">=</span> <span class="st">'perc'</span>, y <span class="op">=</span> target_cont,   </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> demo_data,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>            fit_reg <span class="op">=</span> <span class="va">True</span>, scatter_kws<span class="op">=</span>{<span class="st">'alpha'</span>: <span class="fl">0.4</span>, <span class="st">'s'</span>: <span class="dv">8</span> })</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Percent Category Labeled Most Important Problem that Year"</span>)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Log Mean Reported Demonstration Size)"</span>)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Salience vs Log Mean Size"</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-51-output-1.png" width="469" height="488" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="linear-model" class="level4">
<h4 class="anchored" data-anchor-id="linear-model">Linear Model</h4>
<div id="589b6921" class="cell" data-execution_count="51">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>ols_log_size_mean_by_perc <span class="op">=</span> ols(formula <span class="op">=</span> <span class="st">'log_size_mean ~ perc'</span>, data <span class="op">=</span> demo_data)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>ols_log_size_mean_by_perc_fit <span class="op">=</span> ols_log_size_mean_by_perc.fit()</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( ols_log_size_mean_by_perc_fit.summary() )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:          log_size_mean   R-squared:                       0.001
Model:                            OLS   Adj. R-squared:                  0.001
Method:                 Least Squares   F-statistic:                     9.961
Date:                Tue, 09 Dec 2025   Prob (F-statistic):            0.00160
Time:                        14:15:09   Log-Likelihood:                -29151.
No. Observations:               14832   AIC:                         5.831e+04
Df Residuals:                   14830   BIC:                         5.832e+04
Df Model:                           1                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------
Intercept      4.6385      0.028    163.077      0.000       4.583       4.694
perc           0.0053      0.002      3.156      0.002       0.002       0.009
==============================================================================
Omnibus:                      518.307   Durbin-Watson:                   1.510
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              974.863
Skew:                           0.272   Prob(JB):                    2.05e-212
Kurtosis:                       4.132   Cond. No.                         33.8
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</code></pre>
</div>
</div>
<p>Despite having an <span class="math inline">\(R^2\)</span> of 0.001, the <span class="math inline">\(F\)</span>-statistic is at 11.73—highly significant. Indeed, both the intercept and perc have very small p-values.</p>
<p>In other words, though the percent category labeled Most Important Problem that year does not explain nearly any of the variance in the log mean reported size of demonstrations, it is nevertheless explaining some of it.</p>
<div id="23a35cdd" class="cell" data-execution_count="52">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>ols_log_size_mean_by_perc_pop <span class="op">=</span> ols(formula <span class="op">=</span> <span class="st">'log_size_mean ~ perc + DP05_0001PE'</span>, data <span class="op">=</span> demo_data)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>ols_log_size_mean_by_perc_pop_fit <span class="op">=</span> ols_log_size_mean_by_perc_pop.fit()</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( ols_log_size_mean_by_perc_pop_fit.summary() )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:          log_size_mean   R-squared:                       0.003
Model:                            OLS   Adj. R-squared:                  0.003
Method:                 Least Squares   F-statistic:                     23.60
Date:                Tue, 09 Dec 2025   Prob (F-statistic):           5.85e-11
Time:                        14:15:09   Log-Likelihood:                -29133.
No. Observations:               14832   AIC:                         5.827e+04
Df Residuals:                   14829   BIC:                         5.829e+04
Df Model:                           2                                         
Covariance Type:            nonrobust                                         
===============================================================================
                  coef    std err          t      P&gt;|t|      [0.025      0.975]
-------------------------------------------------------------------------------
Intercept       4.5775      0.030    151.996      0.000       4.518       4.637
perc            0.0051      0.002      3.016      0.003       0.002       0.008
DP05_0001PE  1.545e-08   2.53e-09      6.100      0.000    1.05e-08    2.04e-08
==============================================================================
Omnibus:                      511.117   Durbin-Watson:                   1.506
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              959.065
Skew:                           0.269   Prob(JB):                    5.52e-209
Kurtosis:                       4.123   Cond. No.                     1.49e+07
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.49e+07. This might indicate that there are
strong multicollinearity or other numerical problems.</code></pre>
</div>
</div>
<p>Adding in population greatly boosts the predictive power.</p>
<div id="f466e849" class="cell" data-execution_count="53">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ols_log_size_mean_by_all = ols(formula = 'log_size_mean ~ .', data = demo_data)</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ols_log_size_mean_by_all_fit = ols_log_size_mean_by_all.fit()</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print( ols_log_size_mean_by_all.summary() )</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="b75f98db" class="cell" data-execution_count="54">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>demo_lm <span class="op">=</span> LinearRegression()  <span class="co"># instantiate</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>demo_lm.fit(X_train, y_train_cont)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R^2 (with the test set):"</span>, demo_lm.score(X_test, y_test_cont))</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R^2 (with the train set):"</span>, demo_lm.score(X_train, y_train_cont))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R^2 (with the test set): -0.15642354529580937
R^2 (with the train set): 0.27818892366226855</code></pre>
</div>
</div>
<p>The linear model with all variables overfits; worse than the null model.</p>
<section id="lasso-regression" class="level5">
<h5 class="anchored" data-anchor-id="lasso-regression">LASSO Regression</h5>
<p>“The advantage of using a cross-validation estimator over the canonical estimator class along with grid search is that they can take advantage of warm-starting by reusing precomputed results in the previous steps of the cross-validation process. This generally leads to speed improvements” (https://scikit-learn.org/stable/glossary.html#term-cross-validation-estimator).</p>
<div id="c3667164" class="cell" data-execution_count="55">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>demo_lasso <span class="op">=</span> LassoCV(n_alphas<span class="op">=</span><span class="dv">100</span>, max_iter<span class="op">=</span><span class="dv">10000</span>, random_state<span class="op">=</span>seed, n_jobs<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>demo_lasso.fit(X_train, y_train_cont)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'LASSO Regression model accuracy (with the test set):'</span>, demo_lasso.score(X_test, y_test_cont))</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'LASSO Regression model accuracy (with the train set):'</span>, demo_lasso.score(X_train, y_train_cont))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>LASSO Regression model accuracy (with the test set): 0.18672887255597936
LASSO Regression model accuracy (with the train set): 0.21958787761663157</code></pre>
</div>
</div>
<div id="d59e2f47" class="cell" data-execution_count="56">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pd.DataFrame([feature_names, demo_lasso.coef_]).T.rename(columns={0:"var_name",1:"coef"}).set_index("var_name").sort_values(by="coef")</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>lasso_coefs <span class="op">=</span> pd.Series(demo_lasso.coef_,index<span class="op">=</span>feature_names, name<span class="op">=</span><span class="st">"coef"</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>lasso_coefs_sort <span class="op">=</span> pd.DataFrame([lasso_coefs,lasso_coefs.<span class="bu">abs</span>().rename(<span class="st">"abs_coef"</span>)]).T.sort_values(<span class="st">"abs_coef"</span>,ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>lasso_coefs_sort <span class="op">=</span> lasso_coefs_sort[lasso_coefs_sort[<span class="st">"coef"</span>] <span class="op">!=</span> <span class="dv">0</span>]</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>lasso_coefs_sort.head(<span class="dv">60</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">coef</th>
<th data-quarto-table-cell-role="th">abs_coef</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">type_march</th>
<td>0.418864</td>
<td>0.418864</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">type_protest</th>
<td>-0.302861</td>
<td>0.302861</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">type_parade</th>
<td>0.148044</td>
<td>0.148044</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">problemname_Rights</th>
<td>0.138886</td>
<td>0.138886</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">problemname_Public Safety</th>
<td>0.131716</td>
<td>0.131716</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">problemname_Fiscal Policy</th>
<td>0.116215</td>
<td>0.116215</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">type_walk-out</th>
<td>0.104975</td>
<td>0.104975</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">perc</th>
<td>0.101703</td>
<td>0.101703</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">problemname_Foreign Policy</th>
<td>-0.091223</td>
<td>0.091223</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">problemname_Politics</th>
<td>0.072837</td>
<td>0.072837</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">type_counterprotest</th>
<td>-0.061861</td>
<td>0.061861</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">year</th>
<td>0.058558</td>
<td>0.058558</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">DP03_0053PE</th>
<td>-0.055814</td>
<td>0.055814</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">type_hunger strike</th>
<td>-0.049166</td>
<td>0.049166</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">DP04_0002PE</th>
<td>0.048181</td>
<td>0.048181</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">DP05_0002PE</th>
<td>-0.041110</td>
<td>0.041110</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">type_kneeling protest</th>
<td>-0.040792</td>
<td>0.040792</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FIPS Code_17031</th>
<td>0.040124</td>
<td>0.040124</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_26065</th>
<td>0.037447</td>
<td>0.037447</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">DP04_0037E</th>
<td>-0.037044</td>
<td>0.037044</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_34003</th>
<td>-0.037034</td>
<td>0.037034</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">DP03_0125PE</th>
<td>-0.034776</td>
<td>0.034776</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">DP04_0042PE</th>
<td>-0.033576</td>
<td>0.033576</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CBSA Code_45180</th>
<td>-0.033195</td>
<td>0.033195</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_05045</th>
<td>-0.031981</td>
<td>0.031981</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">type_die-in</th>
<td>-0.029530</td>
<td>0.029530</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CBSA Code_46100</th>
<td>-0.028377</td>
<td>0.028377</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FIPS Code_06041</th>
<td>-0.028195</td>
<td>0.028195</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_29107</th>
<td>-0.028061</td>
<td>0.028061</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FIPS Code_51101</th>
<td>-0.027195</td>
<td>0.027195</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">type_festival</th>
<td>0.025638</td>
<td>0.025638</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">type_counter protest</th>
<td>-0.025270</td>
<td>0.025270</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_51107</th>
<td>-0.024931</td>
<td>0.024931</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CBSA Code_40740</th>
<td>-0.024350</td>
<td>0.024350</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_27123</th>
<td>0.022815</td>
<td>0.022815</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FIPS Code_13015</th>
<td>-0.022510</td>
<td>0.022510</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_13223</th>
<td>-0.022510</td>
<td>0.022510</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">type_mock execution</th>
<td>-0.022439</td>
<td>0.022439</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">type_aircraft flyover</th>
<td>-0.021952</td>
<td>0.021952</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FIPS Code_08093</th>
<td>-0.021839</td>
<td>0.021839</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">type_protest vandalism</th>
<td>-0.021660</td>
<td>0.021660</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CBSA Code_32300</th>
<td>-0.021432</td>
<td>0.021432</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">type_art projection</th>
<td>-0.021142</td>
<td>0.021142</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CBSA Code_23180</th>
<td>0.020816</td>
<td>0.020816</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CBSA Code_19300</th>
<td>-0.020733</td>
<td>0.020733</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FIPS Code_54039</th>
<td>0.020256</td>
<td>0.020256</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS State Code_51</th>
<td>-0.020216</td>
<td>0.020216</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CBSA Code_43300</th>
<td>-0.019714</td>
<td>0.019714</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CBSA Code_49620</th>
<td>-0.019686</td>
<td>0.019686</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">type_self-immolation protest</th>
<td>-0.019548</td>
<td>0.019548</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_16001</th>
<td>0.019059</td>
<td>0.019059</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FIPS State Code_24</th>
<td>-0.018912</td>
<td>0.018912</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_22047</th>
<td>-0.018011</td>
<td>0.018011</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CBSA Code_19820</th>
<td>0.017975</td>
<td>0.017975</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">CBSA Code_16620</th>
<td>0.017532</td>
<td>0.017532</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">DP05_0071PE</th>
<td>0.017424</td>
<td>0.017424</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_01073</th>
<td>0.016939</td>
<td>0.016939</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">FIPS Code_36055</th>
<td>0.016689</td>
<td>0.016689</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">FIPS Code_13067</th>
<td>-0.016246</td>
<td>0.016246</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">DP03_0077PE</th>
<td>-0.016142</td>
<td>0.016142</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h4>
<div id="02613b1c" class="cell" data-execution_count="57">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>demo_logit <span class="op">=</span> LogisticRegression(penalty<span class="op">=</span><span class="st">"l2"</span>, C<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span>seed, max_iter<span class="op">=</span><span class="dv">1000</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>demo_logit.fit(X_train, y_train_cat)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>kfold <span class="op">=</span> KFold(<span class="dv">5</span>, random_state <span class="op">=</span> seed, shuffle <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>grid_logit <span class="op">=</span> GridSearchCV(demo_logit, {<span class="st">'C'</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>]}, cv <span class="op">=</span> kfold, scoring <span class="op">=</span> <span class="st">"accuracy"</span>, n_jobs<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>grid_logit.fit(X_train, y_train_cat)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_logit.best_params_ )</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_logit.cv_results_[(<span class="st">'mean_test_score'</span>)] )</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>demo_logit <span class="op">=</span> grid_logit.best_estimator_</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Logit model accuracy (with the test set):'</span>, demo_logit.score(X_test, y_test_cat))</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Logit model accuracy (with the train set):'</span>, demo_logit.score(X_train, y_train_cat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'C': 0.01}
[0.55583649 0.55794353 0.55794353 0.55254952 0.54892541 0.54631268
 0.54285714]
Logit model accuracy (with the test set): 0.5571284125379171
Logit model accuracy (with the train set): 0.6268015170670038</code></pre>
</div>
</div>
</section>
</section>
<section id="tree" class="level3">
<h3 class="anchored" data-anchor-id="tree">Tree</h3>
<section id="regression-tree" class="level4">
<h4 class="anchored" data-anchor-id="regression-tree">Regression Tree</h4>
<div id="7ba4be2c" class="cell" data-execution_count="58">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>demo_dtr <span class="op">=</span> DecisionTreeRegressor(max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span>seed)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>demo_dtr.fit(X_train,y_train_cont)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>demo_dtr.score(X_test,y_test_cont)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>0.14417389501572087</code></pre>
</div>
</div>
<p>Run cross-validation to choose the best <code>max_depth</code> and <code>criterion</code>.</p>
<div id="bc8f25b8" class="cell" data-execution_count="59">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>param_grid_dtr <span class="op">=</span> {<span class="st">'max_depth'</span>: <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">15</span>)}</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>                 <span class="co">#'criterion':('absolute_error', 'squared_error', 'friedman_mse', 'poisson')} </span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>grid_dtr <span class="op">=</span> GridSearchCV(demo_dtr, param_grid_dtr, cv <span class="op">=</span> kfold, scoring <span class="op">=</span> <span class="va">None</span>, n_jobs<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>grid_dtr.fit(X_train, y_train_cont)</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_dtr.best_params_ )</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_dtr.cv_results_[(<span class="st">'mean_test_score'</span>)] )</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>demo_dtr <span class="op">=</span> grid_dtr.best_estimator_</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'max_depth': 6}
[ 0.14812245  0.16731579  0.17027533  0.17241069  0.1611117   0.14299829
  0.11036709  0.08475928  0.04373906  0.01503987 -0.01727454 -0.05137157]</code></pre>
</div>
</div>
<div id="c9b0742a" class="cell" data-execution_count="60">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>demo_dtr.score(X_test,y_test_cont)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>0.1769892216157133</code></pre>
</div>
</div>
<p>Tree does decently well, even on the test data.</p>
<div id="698374cd" class="cell" data-execution_count="61">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>plt.figure(dpi<span class="op">=</span><span class="dv">1000</span>,figsize<span class="op">=</span>(<span class="dv">9</span>,<span class="dv">3</span>))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>plot_tree(demo_dtr, feature_names <span class="op">=</span> np.setdiff1d(demo_train.columns, targets), filled<span class="op">=</span><span class="va">True</span>, max_depth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-62-output-1.png" width="7174" height="2510" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="e9badb46" class="cell" data-execution_count="62">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>plt.figure(dpi<span class="op">=</span><span class="dv">1000</span>,figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">3</span>))</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>plot_tree(demo_dtr, feature_names <span class="op">=</span> np.setdiff1d(demo_train.columns, targets), filled<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-63-output-1.png" width="11825" height="2510" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>type_protest</code>, <code>type_march</code>, and <code>perc</code> were the three most important variables. Other important ones include <code>DP03_0087PE</code> (Mean family income in 2024 inflation-adjusted dollars)—higher has larger crowds—and <code>DP04_0088PE</code> (Percent of owner-occupied units that are worth $1,000,000 or more)—higher has larger crowds.</p>
</section>
<section id="classification-tree" class="level4">
<h4 class="anchored" data-anchor-id="classification-tree">Classification Tree</h4>
<div id="089df5ec" class="cell" data-execution_count="63">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>demo_dtc <span class="op">=</span> DecisionTreeClassifier(max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span>seed)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>demo_dtc.fit(X_train,y_train_cat)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>demo_dtc.score(X_test,y_test_cat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>0.5840916750926862</code></pre>
</div>
</div>
<div id="bffe188c" class="cell" data-execution_count="64">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>param_grid_dtc <span class="op">=</span> {<span class="st">'max_depth'</span>: <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">15</span>, <span class="dv">2</span>),</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"criterion"</span>:(<span class="st">"gini"</span>,<span class="st">"entropy"</span>,<span class="st">"log_loss"</span>)}</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>grid_dtc <span class="op">=</span> GridSearchCV(demo_dtc, param_grid_dtc, cv <span class="op">=</span> kfold, scoring <span class="op">=</span> <span class="st">"accuracy"</span>, n_jobs<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>grid_dtc.fit(X_train, y_train_cat)</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_dtc.best_params_ )</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_dtc.cv_results_[(<span class="st">'mean_test_score'</span>)] )</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>demo_dtc <span class="op">=</span> grid_dtc.best_estimator_</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'criterion': 'gini', 'max_depth': 7}
[0.56923725 0.56746734 0.57572693 0.56409608 0.5585335  0.54892541
 0.56064054 0.57378845 0.56687737 0.55988201 0.55819638 0.5507796
 0.56064054 0.57378845 0.56687737 0.55988201 0.55819638 0.5507796 ]</code></pre>
</div>
</div>
<div id="0a41f92c" class="cell" data-execution_count="65">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>demo_dtc.score(X_test,y_test_cat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>0.570273003033367</code></pre>
</div>
</div>
<div id="65d6ff23" class="cell" data-execution_count="66">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>plt.figure(dpi<span class="op">=</span><span class="dv">1000</span>,figsize<span class="op">=</span>(<span class="fl">7.5</span>,<span class="dv">3</span>))</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>plot_tree(demo_dtc, feature_names <span class="op">=</span> np.setdiff1d(demo_train.columns, targets), filled<span class="op">=</span><span class="va">True</span>, max_depth<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-67-output-1.png" width="6012" height="2510" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="4117d5aa" class="cell" data-execution_count="67">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>plt.figure(dpi<span class="op">=</span><span class="dv">1000</span>,figsize<span class="op">=</span>(<span class="dv">21</span>,<span class="dv">3</span>))</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>plot_tree(demo_dtc, feature_names<span class="op">=</span>np.setdiff1d(demo_train.columns, targets), filled<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-68-output-1.png" width="16475" height="2510" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>type_protest</code>, <code>type_walk-out</code>, <code>walk-out</code>, and <code>perc</code> were the three most important variables. Other important ones include <code>type_march</code>, <code>problemname_Social Policy</code>.</p>
<p>Interesting to note are <code>DP02_0123PE</code> (percent of the population 5 years or older that speaks a language at home other than English and that speaks English less than “very well”)—higher percents have larger protests—and <code>DP02_0031PE</code> (percent of females 15 years old or older who are married)—higher percents have larger protests.</p>
</section>
</section>
<section id="random-forest" class="level3">
<h3 class="anchored" data-anchor-id="random-forest">Random Forest</h3>
<section id="random-forest-regression" class="level4">
<h4 class="anchored" data-anchor-id="random-forest-regression">Random Forest Regression</h4>
<div id="5ab19e82" class="cell" data-execution_count="68">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>demo_rfr <span class="op">=</span> RandomForestRegressor(n_estimators<span class="op">=</span><span class="dv">100</span>, max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span>seed, n_jobs<span class="op">=</span><span class="dv">6</span>)  <span class="co"># instantiate</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>demo_rfr.fit(X_train, y_train_cont)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R^2 (with the test data):"</span>, demo_rfr.score(X_test, y_test_cont))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R^2 (with the test data): 0.1619130328198617</code></pre>
</div>
</div>
<div id="a0bb9623" class="cell" data-execution_count="69">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>param_grid_rf <span class="op">=</span> {</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>: [<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>],</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'n_estimators'</span>: [<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>]</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>grid_rfr <span class="op">=</span> GridSearchCV(demo_rfr, param_grid_rf, cv <span class="op">=</span> kfold, scoring <span class="op">=</span> <span class="va">None</span>, n_jobs<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>grid_rfr.fit(X_train, y_train_cont)</span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_rfr.best_params_ )</span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_rfr.cv_results_[(<span class="st">'mean_test_score'</span>)] )</span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>demo_rfr <span class="op">=</span> grid_rfr.best_estimator_</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'max_depth': 9, 'n_estimators': 30}
[0.15768497 0.16192606 0.16214603 0.16208336 0.16329129 0.16385098
 0.18776618 0.19346854 0.19431596 0.19497176 0.19588285 0.19641441
 0.19264551 0.20388399 0.20754226 0.208607   0.21030852 0.21088775
 0.1844065  0.20097346 0.20660146 0.20845569 0.21011724 0.21117339
 0.16084529 0.1854004  0.1944433  0.19801754 0.20104798 0.20338438]</code></pre>
</div>
</div>
<p>Best: max depth 9, 30 estimators</p>
<div id="15bafbcb" class="cell" data-execution_count="70">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>demo_rfr.score(X_test, y_test_cont)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>0.20058453473078486</code></pre>
</div>
</div>
<div id="bdfaa113" class="cell" data-execution_count="71">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>rfr_feature_imp <span class="op">=</span> pd.DataFrame({<span class="st">'Feature'</span>: feature_names, <span class="st">'Gini Importance'</span>: demo_rfr.feature_importances_}).sort_values(</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Gini Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>rfr_feature_imp <span class="op">=</span> rfr_feature_imp.merge(census_vars[[<span class="st">"VARIABLE"</span>,<span class="st">"LABEL"</span>]], how<span class="op">=</span><span class="st">"left"</span>, left_on<span class="op">=</span><span class="st">"Feature"</span>, right_on<span class="op">=</span><span class="st">"VARIABLE"</span>).drop(columns<span class="op">=</span><span class="st">"VARIABLE"</span>).fillna(<span class="st">""</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>rfr_feature_imp.head(<span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Gini Importance</th>
<th data-quarto-table-cell-role="th">LABEL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>type_protest</td>
<td>0.184465</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>perc</td>
<td>0.118341</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>type_march</td>
<td>0.110952</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>type_parade</td>
<td>0.030304</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>problemname_Fiscal Policy</td>
<td>0.020216</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>problemname_Rights</td>
<td>0.018637</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>DP04_0054PE</td>
<td>0.012728</td>
<td>Percent!!YEAR HOUSEHOLDER MOVED INTO UNIT!!Occupied housing units!!Moved in 1990 to 1999</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>problemname_Social Policy</td>
<td>0.012473</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>type_rally</td>
<td>0.011043</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>DP04_0042PE</td>
<td>0.009704</td>
<td>Percent!!BEDROOMS!!Total housing units!!3 bedrooms</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>DP04_0136PE</td>
<td>0.009179</td>
<td>Percent!!GROSS RENT AS A PERCENTAGE OF HOUSEHOLD INCOME (GRAPI)!!Occupied units paying rent (excluding units where GRAPI cannot be computed)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>problemname_Foreign Policy</td>
<td>0.008523</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>DP05_0011PE</td>
<td>0.007093</td>
<td>Percent!!SEX AND AGE!!35 to 44 years</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>DP04_0055PE</td>
<td>0.006382</td>
<td>Percent!!YEAR HOUSEHOLDER MOVED INTO UNIT!!Occupied housing units!!Moved in 1980 to 1989</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>DP03_0085PE</td>
<td>0.006218</td>
<td>Percent!!INCOME AND BENEFITS (IN 2017 INFLATION-ADJUSTED DOLLARS)!!Families!!$200,000 or more</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>problemname_Public Safety</td>
<td>0.005953</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>type_counterprotest</td>
<td>0.005845</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17</th>
<td>DP03_0087E</td>
<td>0.005586</td>
<td>Estimate!!INCOME AND BENEFITS (IN 2017 INFLATION-ADJUSTED DOLLARS)!!Families!!Mean family income (dollars)</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18</th>
<td>problemname_Politics</td>
<td>0.005479</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">19</th>
<td>DP04_0081PE</td>
<td>0.005265</td>
<td>Percent!!VALUE!!Owner-occupied units!!Less than $50,000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>New information: <code>DP02_0064PE</code> (percent of the population 25 years old or older that has graduated from high school or the equivalent) and <code>DP02_0061PE</code> (percent of the population 25 years old or older that has a 9th–12th-grade education without a high school diploma) are also important, as is local effects (a la the categorical <code>FIPS Code</code>). Rounding out the top 20 are <code>DP03_0085PE</code> (percent of families whose income and benefits (in 2024 inflation-adjusted dollars) equal or exceed $200,000), `DP02_0065PE</p>
</section>
<section id="random-forest-classification" class="level4">
<h4 class="anchored" data-anchor-id="random-forest-classification">Random Forest Classification</h4>
<div id="3508d018" class="cell" data-execution_count="72">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>demo_rfc <span class="op">=</span> RandomForestClassifier(n_estimators<span class="op">=</span><span class="dv">100</span>, max_depth<span class="op">=</span><span class="dv">3</span>, random_state<span class="op">=</span>seed, n_jobs<span class="op">=</span><span class="dv">6</span>)  <span class="co"># instantiate</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>demo_rfc.fit(X_train, y_train_cat)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'RFC model accuracy (with the test set):'</span>, demo_rfc.score(X_test, y_test_cat))</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'RFC model accuracy (with the train set):'</span>, demo_rfc.score(X_train, y_train_cat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>RFC model accuracy (with the test set): 0.523087293562521
RFC model accuracy (with the train set): 0.5372945638432364</code></pre>
</div>
</div>
<div id="67d6632c" class="cell" data-execution_count="73">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>grid_rfc <span class="op">=</span> GridSearchCV(demo_rfc, param_grid_rf, cv <span class="op">=</span> kfold, scoring <span class="op">=</span> <span class="va">None</span>, n_jobs<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>grid_rfc.fit(X_train, y_train_cat)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_rfc.best_params_ )</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_rfc.cv_results_[(<span class="st">'mean_test_score'</span>)])</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>demo_rfc <span class="op">=</span> grid_rfc.best_estimator_</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'max_depth': 11, 'n_estimators': 30}
[0.52465234 0.50931311 0.5179941  0.51748841 0.51917404 0.517067
 0.51672988 0.51959545 0.52330383 0.52633797 0.52718078 0.52701222
 0.53173198 0.52734935 0.53147914 0.52920354 0.53080489 0.5325748
 0.52743363 0.53147914 0.53409187 0.53442899 0.53021492 0.53375474
 0.52751791 0.52911926 0.53333333 0.53426043 0.53518753 0.53687316]</code></pre>
</div>
</div>
<div id="128e0758" class="cell" data-execution_count="74">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>demo_rfc.score(X_test, y_test_cat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>0.5308392315470172</code></pre>
</div>
</div>
<div id="f00feff3" class="cell" data-execution_count="75">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>rfc_feature_imp <span class="op">=</span> pd.DataFrame({<span class="st">'Feature'</span>: feature_names, <span class="st">'Gini Importance'</span>: demo_rfc.feature_importances_}).sort_values(</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Gini Importance'</span>, ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>rfc_feature_imp <span class="op">=</span> rfc_feature_imp.merge(census_vars[[<span class="st">"VARIABLE"</span>,<span class="st">"LABEL"</span>]], how<span class="op">=</span><span class="st">"left"</span>, left_on<span class="op">=</span><span class="st">"Feature"</span>, right_on<span class="op">=</span><span class="st">"VARIABLE"</span>).drop(columns<span class="op">=</span><span class="st">"VARIABLE"</span>).fillna(<span class="st">""</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>rfc_feature_imp.head(<span class="dv">20</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="75">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Feature</th>
<th data-quarto-table-cell-role="th">Gini Importance</th>
<th data-quarto-table-cell-role="th">LABEL</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>perc</td>
<td>0.056612</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>type_protest</td>
<td>0.052579</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>type_march</td>
<td>0.045003</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>problemname_Social Policy</td>
<td>0.033779</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>problemname_Public Safety</td>
<td>0.031958</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>type_walk-out</td>
<td>0.027177</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>type_rally</td>
<td>0.018971</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>problemname_Rights</td>
<td>0.018331</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">8</th>
<td>problemname_Politics</td>
<td>0.015329</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">9</th>
<td>problemname_Fiscal Policy</td>
<td>0.013887</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">10</th>
<td>problemname_Economy</td>
<td>0.012482</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">11</th>
<td>DP04_0055PE</td>
<td>0.009833</td>
<td>Percent!!YEAR HOUSEHOLDER MOVED INTO UNIT!!Occupied housing units!!Moved in 1980 to 1989</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">12</th>
<td>DP04_0056PE</td>
<td>0.007654</td>
<td>Percent!!YEAR HOUSEHOLDER MOVED INTO UNIT!!Occupied housing units!!Moved in 1979 and earlier</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">13</th>
<td>DP04_0054PE</td>
<td>0.007399</td>
<td>Percent!!YEAR HOUSEHOLDER MOVED INTO UNIT!!Occupied housing units!!Moved in 1990 to 1999</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">14</th>
<td>DP04_0053PE</td>
<td>0.006564</td>
<td>Percent!!YEAR HOUSEHOLDER MOVED INTO UNIT!!Occupied housing units!!Moved in 2000 to 2009</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">15</th>
<td>problemname_Foreign Policy</td>
<td>0.006220</td>
<td></td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">16</th>
<td>problemname_Environment</td>
<td>0.006102</td>
<td></td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">17</th>
<td>DP05_0063PE</td>
<td>0.005647</td>
<td>Percent!!RACE!!Race alone or in combination with one or more other races!!Total population</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">18</th>
<td>DP03_0062E</td>
<td>0.005143</td>
<td>Estimate!!INCOME AND BENEFITS (IN 2017 INFLATION-ADJUSTED DOLLARS)!!Total households!!Median household income (dollars)</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">19</th>
<td>type_demonstration</td>
<td>0.005115</td>
<td></td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here, we see entirely different demographic variables: for some reason, the percent of occupied housing units moved into in different decades continuese to be significant.</p>
</section>
</section>
<section id="k-nearest-neighbors" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors">K Nearest Neighbors</h3>
<section id="k-nearest-neighbors-regression" class="level4">
<h4 class="anchored" data-anchor-id="k-nearest-neighbors-regression">K Nearest Neighbors Regression</h4>
<div id="be3666ca" class="cell" data-execution_count="76">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>demo_knnr <span class="op">=</span> KNeighborsRegressor()</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>param_grid_knn <span class="op">=</span> {<span class="st">'n_neighbors'</span>: <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">31</span>)} </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>grid_knnr <span class="op">=</span> GridSearchCV(demo_knnr, param_grid_knn, cv <span class="op">=</span> kfold, scoring <span class="op">=</span> <span class="va">None</span>, n_jobs<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>grid_knnr.fit(X_train, y_train_cont)</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_knnr.best_params_ )</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_knnr.cv_results_[(<span class="st">'mean_test_score'</span>)] )</span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>demo_knnr<span class="op">=</span>grid_knnr.best_estimator_</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'n_neighbors': 26}
[-6.53035414e-01 -2.92669827e-01 -1.79354868e-01 -1.16417197e-01
 -7.81538518e-02 -5.92372696e-02 -3.78634459e-02 -2.80372772e-02
 -1.89615944e-02 -1.24778031e-02 -8.13331838e-03 -3.17380360e-03
 -4.03993555e-04  3.64452251e-03  8.27996933e-03  1.07450584e-02
  1.29466114e-02  1.76289036e-02  1.99889714e-02  1.86647782e-02
  2.03448227e-02  2.07297524e-02  2.14586801e-02  2.34203746e-02
  2.50014628e-02  2.70849654e-02  2.56022475e-02  2.51018889e-02
  2.57752494e-02  2.57046253e-02]</code></pre>
</div>
</div>
<div id="d542df1d" class="cell" data-execution_count="77">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>demo_knnr.score(X_test, y_test_cont)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="77">
<pre><code>0.03926370116160571</code></pre>
</div>
</div>
<p>KNN tried its best, but it is not the correct model to use here.</p>
</section>
<section id="k-nearest-neighbors-classification" class="level4">
<h4 class="anchored" data-anchor-id="k-nearest-neighbors-classification">K Nearest Neighbors Classification</h4>
<div id="ac224b42" class="cell" data-execution_count="78">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>demo_knnc <span class="op">=</span> KNeighborsClassifier()</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>grid_knnc <span class="op">=</span> GridSearchCV(demo_knnc, param_grid_knn, cv <span class="op">=</span> kfold, scoring <span class="op">=</span> <span class="st">"accuracy"</span>, n_jobs<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>grid_knnc.fit(X_train, y_train_cat)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_knnc.best_params_ )</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_knnc.cv_results_[(<span class="st">'mean_test_score'</span>)] )</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>demo_knnc<span class="op">=</span>grid_knnc.best_estimator_</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'n_neighbors': 19}
[0.47576907 0.49313106 0.49692373 0.49599663 0.49768226 0.49919933
 0.49717657 0.4997893  0.49852507 0.50375053 0.50366625 0.50198062
 0.50096924 0.49852507 0.50046355 0.50223346 0.50316056 0.50493047
 0.50535188 0.50273915 0.50088496 0.50105352 0.49801938 0.50004214
 0.50198062 0.50299199 0.50172777 0.50467762 0.50198062 0.5002107 ]</code></pre>
</div>
</div>
<div id="fa5195e2" class="cell" data-execution_count="79">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>demo_knnc.score(X_test, y_test_cat)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>0.5116279069767442</code></pre>
</div>
</div>
<p>Barely better than chance.</p>
</section>
</section>
</section>
<section id="model-evaluation" class="level2">
<h2 class="anchored" data-anchor-id="model-evaluation">Model Evaluation</h2>
<section id="check-performance-metrics-like-accuracy-precision-f1-score-recall." class="level3">
<h3 class="anchored" data-anchor-id="check-performance-metrics-like-accuracy-precision-f1-score-recall.">Check performance metrics like Accuracy, Precision, F1-score, Recall.</h3>
<div id="f754a613" class="cell" data-execution_count="80">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Logit Classification</span><span class="ch">\n</span><span class="st">"</span>, classification_report( y_test_cat, demo_logit.predict(X_test), zero_division<span class="op">=</span><span class="fl">0.0</span> ) )</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Decision Tree Classification</span><span class="ch">\n</span><span class="st">"</span>, classification_report( y_test_cat, demo_dtc.predict(X_test), zero_division<span class="op">=</span><span class="fl">0.0</span> ) )</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Random Forest Classification</span><span class="ch">\n</span><span class="st">"</span>, classification_report( y_test_cat, demo_rfc.predict(X_test), zero_division<span class="op">=</span><span class="fl">0.0</span> ) )</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"K Nearest Neighbors Classification</span><span class="ch">\n</span><span class="st">"</span>, classification_report( y_test_cat, demo_knnc.predict(X_test), zero_division<span class="op">=</span><span class="fl">0.0</span> ) )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logit Classification
               precision    recall  f1-score   support

           1       0.58      0.56      0.57      1266
           2       0.56      0.65      0.60      1398
           3       0.30      0.13      0.18       267
           4       0.29      0.06      0.09        36

    accuracy                           0.56      2967
   macro avg       0.43      0.35      0.36      2967
weighted avg       0.54      0.56      0.54      2967

Decision Tree Classification
               precision    recall  f1-score   support

           1       0.58      0.63      0.60      1266
           2       0.58      0.62      0.60      1398
           3       0.32      0.13      0.19       267
           4       0.00      0.00      0.00        36

    accuracy                           0.57      2967
   macro avg       0.37      0.34      0.35      2967
weighted avg       0.55      0.57      0.56      2967

Random Forest Classification
               precision    recall  f1-score   support

           1       0.53      0.56      0.54      1266
           2       0.53      0.62      0.57      1398
           3       0.25      0.01      0.01       267
           4       0.00      0.00      0.00        36

    accuracy                           0.53      2967
   macro avg       0.33      0.30      0.28      2967
weighted avg       0.50      0.53      0.50      2967

K Nearest Neighbors Classification
               precision    recall  f1-score   support

           1       0.50      0.55      0.52      1266
           2       0.53      0.59      0.56      1398
           3       0.00      0.00      0.00       267
           4       0.00      0.00      0.00        36

    accuracy                           0.51      2967
   macro avg       0.26      0.28      0.27      2967
weighted avg       0.46      0.51      0.48      2967
</code></pre>
</div>
</div>
<p>Recall of the biggest demonstration sizes is more important here, as it is better to allocate resources where they are not needed than to not when they are necessary. As such, though the best logistic regression model has a lower overall accuracy than the best decision tree classifier, as it is slightly better at predicting those larger demonstration sizes, that looks to be the best model.</p>
</section>
<section id="plot-the-one-vs.-rest-multiclass-roc-auc-curves-for-the-best-trained-classifiers" class="level3">
<h3 class="anchored" data-anchor-id="plot-the-one-vs.-rest-multiclass-roc-auc-curves-for-the-best-trained-classifiers">Plot the One vs.&nbsp;Rest multiclass ROC-AUC curves for the best trained classifiers</h3>
<p>ROC-AUC can only be applied to binary classifiers. As such, a One vs.&nbsp;Rest strategy may be used, plotting multiple curves: one for each class, where a failure is a classification of any of the others.</p>
<div id="ef75f6b7" class="cell" data-execution_count="81">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>label_binarizer <span class="op">=</span> LabelBinarizer().fit(y_train_cat) <span class="co"># sourced from https://scikit-learn.org/stable/auto_examples/model_selection/plot_roc.html</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>y_test_cat_onehot <span class="op">=</span> label_binarizer.transform(y_test_cat)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="co"># y_test_cat_onehot.shape  # (n_samples, n_classes)</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>class_names<span class="op">=</span>y_test_cat.unique().sort_values()</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> OvR_ROC_AUC(X_test, y_test_onehot, cat_model, cat_model_name, classes, class_names):</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> class_of_interest <span class="kw">in</span> classes:</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>        class_id <span class="op">=</span> np.flatnonzero(label_binarizer.classes_ <span class="op">==</span> class_of_interest)[<span class="dv">0</span>]</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>        fpr, tpr, _ <span class="op">=</span> roc_curve(y_test_onehot[:, class_id], cat_model.predict_proba(X_test)[:, <span class="dv">1</span>])</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>        roc_auc <span class="op">=</span> auc(fpr, tpr)</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>        plt.plot(fpr, tpr, label<span class="op">=</span><span class="ss">f"</span><span class="sc">{</span>cat_model_name<span class="sc">}</span><span class="ss"> Class </span><span class="sc">{</span>class_names[class_id]<span class="sc">}</span><span class="ss"> vs. the rest (AUC = </span><span class="sc">{</span>roc_auc<span class="sc">:.2f}</span><span class="ss">)"</span>)</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>    plt.plot([<span class="dv">0</span>, <span class="dv">1</span>], [<span class="dv">0</span>, <span class="dv">1</span>], <span class="st">'r--'</span>, label<span class="op">=</span><span class="st">'Random Guess'</span>)</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'False Positive Rate'</span>)</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'True Positive Rate'</span>)</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="ss">f'One-vs-Rest ROC Curves: </span><span class="sc">{</span>cat_model_name<span class="sc">}</span><span class="ss"> Classifier'</span>)</span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>OvR_ROC_AUC(X_test, y_test_cat_onehot, cat_model<span class="op">=</span>demo_logit, cat_model_name<span class="op">=</span><span class="st">"Logistic"</span>, classes<span class="op">=</span>label_binarizer.classes_, class_names<span class="op">=</span>class_names)</span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>OvR_ROC_AUC(X_test, y_test_cat_onehot, cat_model<span class="op">=</span>demo_dtc, cat_model_name<span class="op">=</span><span class="st">"Tree"</span>, classes<span class="op">=</span>label_binarizer.classes_, class_names<span class="op">=</span>class_names)</span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>OvR_ROC_AUC(X_test, y_test_cat_onehot, cat_model<span class="op">=</span>demo_rfc, cat_model_name<span class="op">=</span><span class="st">"Random Forest"</span>, classes<span class="op">=</span>label_binarizer.classes_, class_names<span class="op">=</span>class_names)</span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>OvR_ROC_AUC(X_test, y_test_cat_onehot, cat_model<span class="op">=</span>demo_knnc, cat_model_name<span class="op">=</span><span class="st">"KNN"</span>, classes<span class="op">=</span>label_binarizer.classes_, class_names<span class="op">=</span>class_names)</span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a><span class="co"># # Logit</span></span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a><span class="co"># fpr, tpr, _ = roc_curve(y_test_cat, demo_logit.predict_proba(X_test)[:, 1])</span></span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a><span class="co"># roc_auc = auc(fpr, tpr)</span></span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot(fpr, tpr, label=f'Logistic (AUC = {roc_auc:.2f})')</span></span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a><span class="co"># # Decision Tree</span></span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a><span class="co"># fpr, tpr, _ = roc_curve(y_test_cat, demo_dtc.predict_proba(X_test)[:, 1])</span></span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a><span class="co"># roc_auc = auc(fpr, tpr)</span></span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot(fpr, tpr, label=f'Tree (AUC = {roc_auc:.2f})')</span></span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a><span class="co"># # Random Forest</span></span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a><span class="co"># fpr, tpr, _ = roc_curve(y_test_cat, demo_rfc.predict_proba(X_test)[:, 1])</span></span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a><span class="co"># roc_auc = auc(fpr, tpr)</span></span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot(fpr, tpr, label=f'Random Forest (AUC = {roc_auc:.2f})')</span></span>
<span id="cb122-41"><a href="#cb122-41" aria-hidden="true" tabindex="-1"></a><span class="co"># # KNN</span></span>
<span id="cb122-42"><a href="#cb122-42" aria-hidden="true" tabindex="-1"></a><span class="co"># fpr, tpr, _ = roc_curve(y_test_cat, demo_knnc.predict_proba(X_test)[:, 1])</span></span>
<span id="cb122-43"><a href="#cb122-43" aria-hidden="true" tabindex="-1"></a><span class="co"># roc_auc = auc(fpr, tpr)</span></span>
<span id="cb122-44"><a href="#cb122-44" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot(fpr, tpr, label=f'KNN (AUC = {roc_auc:.2f})')</span></span>
<span id="cb122-45"><a href="#cb122-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-46"><a href="#cb122-46" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot([0, 1], [0, 1], 'r--', label='Random Guess')</span></span>
<span id="cb122-47"><a href="#cb122-47" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.xlabel('False Positive Rate')</span></span>
<span id="cb122-48"><a href="#cb122-48" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.ylabel('True Positive Rate')</span></span>
<span id="cb122-49"><a href="#cb122-49" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.title('ROC Curves for Two Models')</span></span>
<span id="cb122-50"><a href="#cb122-50" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.legend()</span></span>
<span id="cb122-51"><a href="#cb122-51" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-82-output-1.png" width="589" height="449" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-82-output-2.png" width="589" height="449" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-82-output-3.png" width="589" height="449" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-82-output-4.png" width="589" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Judging by the ROC-AUC curves, the best decision tree would appear to be the best model. It is the worst at predicting Class 1s, but as that is the smallest class, it is the least essential to distribute resources appropriately for.</p>
</section>
<section id="plot-the-residuals-for-the-best-trained-regressors" class="level3">
<h3 class="anchored" data-anchor-id="plot-the-residuals-for-the-best-trained-regressors">Plot the residuals for the best trained regressors</h3>
<div id="ec5ec583" class="cell" data-execution_count="82">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># linear model</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>plt.scatter(y_test_cont, y_test_cont <span class="op">-</span> demo_lm.predict(X_test))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"True Value"</span>)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residual'</span>)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Linear Model Residuals"</span>)</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co"># tree</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(y_test_cont, y_test_cont <span class="op">-</span> demo_dtr.predict(X_test))</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"True Value"</span>)</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residual'</span>)</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Decision Tree Residuals"</span>)</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="co"># random forest</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>plt.scatter(y_test_cont, y_test_cont <span class="op">-</span> demo_rfr.predict(X_test))</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"True Value"</span>)</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residual'</span>)</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Random Forest Residuals"</span>)</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a><span class="co"># knn</span></span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>plt.scatter(y_test_cont, y_test_cont <span class="op">-</span> demo_knnr.predict(X_test))</span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">0</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>)</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"True Value"</span>)</span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Residual'</span>)</span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"K Nearest Neighbors Residuals"</span>)</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-83-output-1.png" width="596" height="449" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-83-output-2.png" width="587" height="449" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-83-output-3.png" width="587" height="449" class="figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-83-output-4.png" width="587" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The residuals all have a clear direction. The linear model appears flattest, but only because it is squashed to show all of the residuals.</p>
<div id="d3f67381" class="cell" data-execution_count="83">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R^2 With the Test Data"</span>)</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Linear Model: </span><span class="sc">{</span>demo_lm<span class="sc">.</span>score(X_test,y_test_cont)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Decision Tree: </span><span class="sc">{</span>demo_dtr<span class="sc">.</span>score(X_test,y_test_cont)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Random Forest: </span><span class="sc">{</span>demo_rfr<span class="sc">.</span>score(X_test,y_test_cont)<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"K Nearest Neighbors: </span><span class="sc">{</span>demo_knnr<span class="sc">.</span>score(X_test,y_test_cont)<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R^2 With the Test Data
Linear Model: -0.16
Decision Tree: 0.18
Random Forest: 0.20
K Nearest Neighbors: 0.04</code></pre>
</div>
</div>
<p>Random Forest explains the most variance. The linear model is worse than the null model, and the KNN regressor is not far off.</p>
</section>
</section>
<section id="dimensionality-reduction" class="level2">
<h2 class="anchored" data-anchor-id="dimensionality-reduction">Dimensionality Reduction</h2>
<section id="primary-component-analysis" class="level3">
<h3 class="anchored" data-anchor-id="primary-component-analysis">Primary Component Analysis</h3>
<div id="172999f6" class="cell" data-execution_count="84">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA Computations</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># X_avg = np.mean(X_train, axis = 0)</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co"># B = X_train - np.tile(X_avg, (len(X_train), 1))</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co"># U, S, VT = np.linalg.svd(B / np.sqrt(len(X_train)), full_matrices=True)</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co"># V = VT.T</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co"># #t = np.arange(0, 1, 0.1)</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="co"># # plt.plot(t, V[1, 0]/V[0, 0] * t)</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="co"># # plt.plot(t, V[1, 1]/V[0, 1] * t)</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.quiver([X_avg[0], X_avg[0]], [X_avg[1],X_avg[1]], V[0,:], V[1,:], scale=8, zorder=2, color=['b', 'r'])</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a><span class="co"># theta = 2 * np.pi * np.arange(0, 1, 0.01)</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Xstd = np.array([np.cos(theta), np.sin(theta)]).T @ np.diag(S) @ VT</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot(Xavg[0] +     Xstd[:, 0], Xavg[1] +     Xstd[:,1])</span></span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot(Xavg[0] + 2 * Xstd[:, 0], Xavg[1] + 2 * Xstd[:,1])</span></span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.plot(Xavg[0] + 3 * Xstd[:, 0], Xavg[1] + 3 * Xstd[:,1])</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.show()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="9a44ab08" class="cell" data-execution_count="85">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>demo_pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="fl">0.95</span>)  <span class="co"># Retain 95% of variance</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>demo_pca.fit(X_train)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>X_train_pca <span class="op">=</span> demo_pca.transform(X_train)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>X_test_pca <span class="op">=</span> demo_pca.transform(X_test)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<div id="1ddbd416" class="cell" data-execution_count="86">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>pca_lm <span class="op">=</span> LinearRegression()</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>pca_lm.fit(X_train_pca,y_train_cont)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R^2 (with the test set):"</span>, pca_lm.score(X_test_pca, y_test_cont))</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"R^2 (with the train set):"</span>, pca_lm.score(X_train_pca, y_train_cont))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>R^2 (with the test set): 0.08984001401778652
R^2 (with the train set): 0.1834276932513884</code></pre>
</div>
</div>
<div id="2ecd21c4" class="cell" data-execution_count="87">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>pca_logit <span class="op">=</span> LogisticRegression(penalty<span class="op">=</span><span class="st">"l2"</span>, C<span class="op">=</span><span class="dv">1</span>, random_state<span class="op">=</span>seed, max_iter<span class="op">=</span><span class="dv">10000</span>)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>pca_logit.fit(X_train_pca,y_train_cat)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>grid_logit <span class="op">=</span> GridSearchCV(pca_logit, {<span class="st">'C'</span>: [<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>]}, cv <span class="op">=</span> kfold, scoring <span class="op">=</span> <span class="st">"accuracy"</span>, n_jobs<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>grid_logit.fit(X_train_pca, y_train_cat)</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_logit.best_params_ )</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( grid_logit.cv_results_[(<span class="st">'mean_test_score'</span>)] )</span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>pca_logit <span class="op">=</span> grid_logit.best_estimator_</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Logit model accuracy (with the test set):'</span>, pca_logit.score(X_test_pca, y_test_cat))</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Logit model accuracy (with the train set):'</span>, pca_logit.score(X_train_pca, y_train_cat))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{'C': 1}
[0.53653603 0.54302571 0.54951538 0.55086389 0.5503582  0.54867257
 0.54479562]
Logit model accuracy (with the test set): 0.5513987192450287
Logit model accuracy (with the train set): 0.6241045090602613</code></pre>
</div>
</div>
<div id="8d4b2d42" class="cell" data-execution_count="88">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Logit Classification</span><span class="ch">\n</span><span class="st">"</span>, classification_report( y_test_cat, pca_logit.predict(X_test_pca) ) )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Logit Classification
               precision    recall  f1-score   support

           1       0.58      0.56      0.57      1266
           2       0.56      0.63      0.59      1398
           3       0.30      0.15      0.20       267
           4       0.22      0.11      0.15        36

    accuracy                           0.55      2967
   macro avg       0.41      0.36      0.38      2967
weighted avg       0.54      0.55      0.54      2967
</code></pre>
</div>
</div>
<p>Slightly worse accuracy, at the advantage of a higher recall for Class 3 and 4.</p>
<div id="9a1c9446" class="cell" data-execution_count="89">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>OvR_ROC_AUC(X_test_pca, y_test_cat_onehot, cat_model<span class="op">=</span>pca_logit, cat_model_name<span class="op">=</span><span class="st">"PCA Logistic"</span>, classes<span class="op">=</span>label_binarizer.classes_, class_names<span class="op">=</span>class_names)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="demonstration-size_files/figure-html/cell-90-output-1.png" width="589" height="449" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>